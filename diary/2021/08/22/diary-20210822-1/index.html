<!DOCTYPE HTML>
<html lang="zh-CN">
    


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Mapbox GL入门, 车舟慢">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="KeoTn_OFy4ndJwXNmm2gMeQfPhd7alqE9vQDwI32KCY">
    <meta name="description" content="什么是MapboxMapbox用于创建自定义应用程序，解决地图、数据和空间分析问题。Mapbox 的工具集是模块化的，用以支持 Web 和移动地图开发制作过程的每个环节。无论您的目标是创建一个精美的地图来适配您的网站，还是建立一个功能齐全的">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Mapbox GL入门 | 车舟慢</title>
    <link rel="icon" type="image/png" href="/diary/favicon.png">

    <link rel="stylesheet" type="text/css" href="/diary/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/diary/css/my.css">
    
    <style type="text/css">
        
    </style>

    <script src="/diary/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

<link rel="stylesheet" href="/diary/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/diary/css/prism-line-numbers.css" type="text/css"></head>

    <body>

        <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/diary/" class="waves-effect waves-light">
                    
                    <img src="/diary/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">车舟慢</span>
                </a>
            </div>
            


<!-- <a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/diary/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
            
            <i class="fa fa-music"></i>
            
            <span>说说</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/galleries" class="waves-effect waves-light">
            
            <i class="fa fa-photo"></i>
            
            <span>相册</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul> -->

<!-- 支持二级菜单特性  -->
<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right nav-menu">
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/" class="waves-effect waves-light">
              
                <i class="fa fa-home"></i>
              
              <span>首页</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/categories" class="waves-effect waves-light">
              
                <i class="fa fa-bookmark"></i>
              
              <span>分类</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/archives" class="waves-effect waves-light">
              
                <i class="fa fa-archive"></i>
              
              <span>归档</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
              
                <i class="fa fa-music"></i>
              
              <span>说说</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/galleries" class="waves-effect waves-light">
              
                <i class="fa fa-photo"></i>
              
              <span>相册</span>
            </a>

            
      </li>
    

    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/diary/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">车舟慢</div>
        <div class="logo-desc">
            
            雁引愁心去，山衔好月来。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/diary/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/diary/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/diary/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-music"></i>
                
                说说
            </a>
        </li>
        
        <li>
            <a href="/diary/galleries" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-photo"></i>
                
                相册
            </a>
        </li>
        
        
    </ul>

   
   
<!-- 支持二级菜单特性   -->
<!-- <ul class="menu-list mobile-menu-list">
    
        <li class="m-nav-item">
                
                    <a href="/diary/" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-home"></i>
                        
                        首页
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/categories" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-bookmark"></i>
                        
                        分类
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/archives" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-archive"></i>
                        
                        归档
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-music"></i>
                        
                        说说
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/galleries" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-photo"></i>
                        
                        相册
                    </a>
              
            </li>
        

        
    </ul> -->

</div>

        </div>

        
    </nav>

</header>

        
<script src="/diary/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/diary/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/diary/medias/featureimages/7.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Mapbox GL入门
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/diary/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/diary/tags/MapboxGL/" target="_blank">
                                <span class="chip bg-color">MapboxGL</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>
            
            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-08-22
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                        sean
                    
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        8.3k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        39 分
                    </div>
                    
                
                
                

            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="什么是Mapbox"><a href="#什么是Mapbox" class="headerlink" title="什么是Mapbox"></a>什么是Mapbox</h2><p>Mapbox用于创建自定义应用程序，解决地图、数据和空间分析问题。Mapbox 的工具集是模块化的，用以支持 Web 和移动地图开发制作过程的每个环节。无论您的目标是创建一个精美的地图来适配您的网站，还是建立一个功能齐全的地理信息处理应用，</p>
<h3 id="Mapbox的地图数据"><a href="#Mapbox的地图数据" class="headerlink" title="Mapbox的地图数据"></a>Mapbox的地图数据</h3><p>Mapbox的地图数据的核心tilesets：Mapbox 街道、Mapbox 地形、Mapbox 交通和 Mapbox 卫星。每一个 tileset 包含各自独一无二的数据集，其来源于多种多样的数据源。  </p>
<ul>
<li>Mapbox 街道包括基于 OpenStreetMap 数据源的街道、建筑物，行政区域，水域和陆地资料，每五分钟更新一次。</li>
<li>Mapbox 地形包括陆地覆盖物资料和全球高程数据集，配有轮廓线、山体阴影和高程数据。</li>
<li>Mapbox 卫星包括各种来源的全球卫星图像，由 Mapbox 处理和缝合。</li>
<li>Mapbox 交通包括 Mapbox 街道上定期更新的车辆拥堵信息。</li>
</ul>  

<p>在矢量瓦片图概览 (<a href="https://docs.mapbox.com/vector-tiles/reference/" target="_blank" rel="noopener">https://docs.mapbox.com/vector-tiles/reference/</a>) 中找到可供使用的 Mapbox 街道，地形和交通来源的完整列表。  </p>
<p>在 <a href="https://www.mapbox.com/about/maps" target="_blank" rel="noopener">https://www.mapbox.com/about/maps</a> 详细了解Mapbox的数据来源  </p>
<h3 id="自定义地图样式"><a href="#自定义地图样式" class="headerlink" title="自定义地图样式"></a>自定义地图样式</h3><p>自定义地图样式是 Mapbox Studio 的核心功能之一。我们提供了一个高级应用将这种定制性让您触手可及：即应用 Mapbox Studio 样式编辑器。在 Mapbox Studio 中，你能够从我们的模板样式或设计样式中的一种地图样式开始，根据您的具体规范设计每个单独图层的样式。  </p>
<p>在 Mapbox Studio 左侧，您可以看到基本样式，即由一组有限图层组成的模板样式。在右侧，您可以看到使用所有相同基础数据的自定义样式，但该样式是通过在 Mapbox Studio 样式编辑器中更改颜色和字体进行自定义设置。  </p>
<p>Mapbox Studio 样式编辑器是一个功能齐全的地图编辑器，您可以直接使用浏览器来完全控制地图的样式。无论是从 Mapbox 模板样式开始还是从头开始，样式设置的可能性实际上是无穷无尽的。使用 Mapbox Studio 样式编辑器，您可以  </p>
<ul>
<li>创建基于缩放级别动态更改的样式。</li>
<li>使用自定义字体</li>
<li>为你的标签设置自定义对齐、倾斜、偏移等</li>
<li>为地图图层设置颜色、权重和透明度。</li>
<li>根据属性过滤 tilesets。</li>
</ul> 

<h3 id="添加自定义数据"><a href="#添加自定义数据" class="headerlink" title="添加自定义数据"></a>添加自定义数据</h3><p>Mapbox 的街道、地形、交通和卫星 tilesets 提供了大量的地理空间数据，但地图应用程序通常需要自定义数据。要将自定义数据添加到地图，你可以以 tilesets 格式或创建 datasets 上传自己的数据。  </p>
<p>注意瓦片集和数据集是有区别的，Tilesets 和数据集是两种不同类型的数据：tilesets 是可渲染的，数据集是可编辑的。样式渲染包括改变像颜色、透明度、字体或者图标等特征。编辑包括改变特征的位置（点、线、形），改变几何形状，从一组特征集合添加或删除特征。如果你创建或导入了一个数据集，那么你可以就在 Mapbox Studio 中导出你的数据集到一个 tileset，并可以在 Mapbox Studio 中像其他 tileset 一样使用它。  </p>
<blockquote>
<p>上传tilesets(瓦片集)  </p>
</blockquote>
<p>tilesets 是矢量数据的轻量级集合，为渲染而适应性优化，并且不可被编辑。当你上传自定义数据，你的文件被转换为 tilesets，它可以在 Mapbox Studio 样式编辑器中设置样式，被添加到 Mapbox GL JS 并被使用于由 Mapbox Maps SDK 创建的移动应用程序。Mapbox Maps SDK for iOS 和 Android。<br>数据上传参考 <a href="http://www.mapbox.cn/help/how-mapbox-works/uploading-data/" target="_blank" rel="noopener">http://www.mapbox.cn/help/how-mapbox-works/uploading-data/</a>  </p>
<blockquote>
<p>创建数据集  </p>
</blockquote>
<p>一个可被编辑的数据集合应该是 GeoJSON 格式的特征。Mapbox 存储的特征具有几何属性和特征属性，两者皆可在 Mapbox Studio 数据集编辑器中编辑或通过调用 Mapbox 的 API 进行编辑。你可以使用 Mapbox Studio 中的数据集编辑器导入、创建和编辑 GeoJSON 点、线和多边形特征及其属性。一旦你处理完数据集，就能够将其导出到 tileset，以便与 Mapbox Studio 样式编辑器一起使用。一次可以加载到 Mapbox Studio 数据集编辑器中的数据量是有限的，但是可以使用 Mapbox 数据集 API 添加更多功能并以代码编辑的方式管理它们。  </p>
<p>创建数据集参考 <a href="http://www.mapbox.cn/help/how-mapbox-works/creating-data/" target="_blank" rel="noopener">http://www.mapbox.cn/help/how-mapbox-works/creating-data/</a>  </p>
<h3 id="创建地图应用"><a href="#创建地图应用" class="headerlink" title="创建地图应用"></a>创建地图应用</h3><p>如果您已经创建了地图、设置了地图样式并将数据添加到地图中，Mapbox 将提供多种工具来将地图集成到网站或自定义地图应用程序中。  </p>
<blockquote>
<p>Web地图应用  </p>
</blockquote>
<p>使用我们的 JavaScript 库将您的地图发布到网络上,使用 HTML、CSS、JavaScript 和 Mapbox GL JS 的组合，Mapbox GL JS是我们基于 WebGL 的 JavaScript 库。  </p>
<p>Mapbox GL JS 是一个 JavaScript 库，用于从 Mapbox 样式和矢量瓦片创建交互式的、可自定义的地图。Mapbox GL JS 使用 WebGL，这是一种用于在浏览器中创建视频游戏的技术，它使您能够在地图中构建高级交互，包括平滑缩放、地图方位和倾角、基础地图数据检索以及动态过滤选定呈现的数据。您可以使用在 Mapbox Studio 样式编辑器中创建的自定义样式或我们提供的任何模板样式，还可以通过代码添加您想要的任何其他数据，包括 geojson、图像甚至视频！  </p>
<blockquote>
<p>移动端应用  </p>
</blockquote>
<p>Mapbox 为 iOS 和 Android 提供了一个 Maps SDK ，用于在原生应用中发布地图。iOS 和 Android 的 Maps SDK 被设计用于替代苹果 Mapkit 和 Google maps SDK 的产品。Maps SDK 对于有这两方面经验的移动开发人员来说应该很熟悉。通常，可以通过更改一行代码将地图替换为 Mapbox  </p>
<p>每个 SDK 绑定了五种 Mapbox 设计的地图样式，可以处理使用 Mapbox Studio 样式编辑器创建自定义地图样式。如果您使用 Mapbox 的一个移动 SDK，您还可以访问移动端使用的数据统计界面，该数据统计界面提供每月活动用户、地图使用情况和按区域度量的连续更新视图。  </p>
<blockquote>
<p>Unity 地图应用  </p>
</blockquote>
<p>Mapbox SDK for Unity 使得模拟真实世界成为可能。Mapbox SDK for Unity 是用于从真实的地图数据构建 Unity 应用程序。它包括一个强大的 API，用以与 Mapbox Web 服务交互，将地图资源转换为游戏对象，以及一个健壮的、构建在 Unity 平台之上图形用户界面。  </p>
<h3 id="拓展您的地图应用"><a href="#拓展您的地图应用" class="headerlink" title="拓展您的地图应用"></a>拓展您的地图应用</h3><p>除了设计地图和发布地图应用程序外，Mapbox 还提供了与数据交互、定位地址、进行空间分析和路径导航的工具。我们提供 Web API 的服务，使用 API 中提供的方法会使地图具有交互性和动态性。  </p>
<blockquote>
<p>Mapbox 地理编码 API  </p>
</blockquote>
<p>使用 Mapbox 地理编码 API 将全局位置搜索添加到应用程序中。使用反向地理编码将纬度和经度值转换为地址，或者使用正向地理编码将地址转换为纬度和经度值。您可以在 Web 或移动应用程序中使用地理编码 API，也可以将其作为独立服务使用。  </p>
<blockquote>
<p>Mapbox 导航 API  </p>
</blockquote>
<p>Mapbox Directions API 基于 OpenStreetMap 中的阡陌交通，为步行、骑车或驾驶提供点到点的导航指引。导航 API 返回文本指令、替代路线、几何图形（用于绘制路线）和动态导航。路径导航 API 还支持我们的地图匹配、路网和路径优化 API。有关更多信息，请参阅路径导航 AP I 文档。  </p>
<blockquote>
<p>Turf.js 分析  </p>
</blockquote>
<p>Turf.js 是一个用于空间分析的开源 Javascript 库。Turf.js 包括传统的空间分析操作、用于创建 GeoJSON 数据的帮助函数以及数据分类和统计工具。您可以将 Turf 作为客户端插件添加到网站，也可以使用 node.js 运行 Turf 服务端。  </p>
<blockquote>
<p>使用卫星影像  </p>
</blockquote>
<p>Mapbox 卫星影像是连续卫星和航空图像的全球基础地图，您可以将其用作空白画布或自己数据的底图。由多个图像源组成，我们对其进行颜色校正，并在新图像可用时进行更新。Mapbox 卫星影像服务使用全球卫星和来自商业卫星提供商、NASA 和 USGS 的航空图像。随着城市的发展和景观的变化，我们增加了更新的、更清晰的和更有吸引力的图像。<br>目前可提供的分辨率级别包括：  </p>
<ul>
<li>0–8: MODIS 2012–2013.</li>
<li>9–12: Landsat 5 &amp; 7, 2010–2011.</li>
<li>13–19：公开和专有资源的组合，包括 DigitalGlobe 的 GBM 2011+，美国农业部的 NAIP 2011-2013，以及丹麦、芬兰和德国部分地区的公开遥感图像。</li>
</ul>


<blockquote>
<p>创建静态地图  </p>
</blockquote>
<p>Mapbox 静态地图 API 可以从地图样式生成静态图像。提供您的样式 id、access token 和一些其他参数（如缩放、方向角、俯仰角和图层），您可以通过在应用程序中发出请求来直接调用显示静态地图。  </p>
<h2 id="MapboxGL核心特点"><a href="#MapboxGL核心特点" class="headerlink" title="MapboxGL核心特点"></a>MapboxGL核心特点</h2><!--  <a href="https://pan.baidu.com/s/1Wlj2Xqn22F2PZ_EotmFbDg" target="_blank">d3-7.0.0.tgz</a>   -->
<p>MapboxGL的核心特点是<font color="red">客户端渲染</font>。在MapboxGL JS中创建 Web 应用时，通过 JavaScript 和 WebGL 把地图作为 vector tiles 进行渲染。 相比将服务器的一系列切片图片组合起来后再显示，通过Mapbox GL JS渲染可以快速改变样式，使得地图的呈现更加多样化。  </p>
<h3 id="地图视角（Camera）"><a href="#地图视角（Camera）" class="headerlink" title="地图视角（Camera）"></a>地图视角（Camera）</h3><p>Leaflet 或 Mapbox.js 库中的地图视角由中心点（centerpoint）和缩放级别（zoom level）决定，缩放级别通常为 0 到 22 之间的整数。Mapbox GL JS 也提供调整地图视角的参数。</p>
<blockquote>
<p>中心点:按经度、纬度顺序排列<br>缩放级别：缩放范围内的任何数值。即使带有小数点，如 1.5 或 6.2，系统也可以正确渲染。<br>方位角(bearing):地图的旋转度。地图可以旋转，右边向上旋转的时候文本标注等详细内容也会正确显示。<br>倾斜度(tilt):地图视角倾斜时的度数。  </p>
</blockquote>
<h3 id="图层-layers"><a href="#图层-layers" class="headerlink" title="图层(layers)"></a>图层(layers)</h3><pre class="line-numbers language-html"><code class="language-html">传统的 JavaScript 地图库有两种完全不同的 "图层"：基础图层和叠加图层。  

基础图层（baselayers）：构成地图基础的图像切片。通常包含大量数据——街道地图包括标注、建筑、图标等细节，在浏览器上渲染的话效果不会太好。可参考 Mapbox.js 中的 L.mapbox.tileLayer 和 Leaflet 中的 L.TileLayer。  

叠加图层（overlays）：通常包括 GeoJSON 之类的矢量数据，参考 Mapbox.js 中的L.mapbox.featureLayer 和 Leaflet 中的 L.geoJson。和基础图层相比，叠加图层包含的信息更少，但交互性更强：可在 JavaScript 中进行修改，并且点击的时候会触发弹窗。  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Mapbox GL JS 对基础图层和叠加图层不作区分。通过Mapbox GL JS，浏览器中的所有地图内容均以矢量数据的形式加载。标签、图标等地图要素节都可以通过 JavaScript 进行修改，与以前的地图库中的叠加图层类似。当然，这也意味着更改图层样式的函数和方法会更细化一点  </p>
<p>Mapbox GL JS 中的图层是对矢量数据或者raster data的风格化呈现。每个图层都将规定特定数据在浏览器中该如何绘制，渲染器（renderer）会通过这些图层把地图渲染到屏幕上。随着缩放级别的改变，地图细节也会变化。地形、建筑、公共交通站台和位置信息都作为其相应的图层来渲染。  </p>
<h3 id="添加地图"><a href="#添加地图" class="headerlink" title="添加地图"></a>添加地图</h3><p>每一个 Mapbox GL JS 项目的基础为mapboxgl.Map类  </p>
<pre class="line-numbers language-html"><code class="language-html">var map = new mapboxgl.Map({
  // container id
   container:'map',
  // style location
   style:'mapbox://styles/mapbox/streets-',
  // starting position
   center:[-74.50, 40],
  zoom:9
});
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>它与 Leaflet 的L.Map类或 Mapbox.js 的 L.mapbox.map相似，但有几个核心的差异：  </p>
<blockquote>
<p>坐标顺序  </p>
</blockquote>
<p>Mapbox GL JS 将坐标处理为数组形式（如[-74.50, 40]），按照 longitude, latitude的顺序排列（而不是 Leaflet 和 Mapbox.js 中latitude, longitude的顺序）。这一顺序与 GeoJSON 中的坐标、其他地理空间格式以及数学中的 X，Y 顺序一致。  </p>
<blockquote>
<p>地图样式  </p>
</blockquote>
<p>地图通过 URL mapbox://styles/mapbox/streets-v 加载样式。该 URL 链接到一个远程文件，地图将其载入后，会用其确定tilesets以及如何为终端客户呈现样式。Mapbox GL JS 在某些地方只允许使用 URLs，不允许字符数据（literal data），包括数据源。</p>
<p>同 JavaScript 库中的其它远程数据源一样，这些数据源是异步的。因此相关代码会使用事件绑定来保证地图在正确的时候做出改变。例如：</p>
<pre class="line-numbers language-js"><code class="language-js">map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token punctuation">:</span><span class="token string">'terrain-data'</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span><span class="token string">'line'</span><span class="token punctuation">,</span>
    source<span class="token punctuation">:</span><span class="token punctuation">{</span>
      type<span class="token punctuation">:</span><span class="token string">'vector'</span><span class="token punctuation">,</span>
      url<span class="token punctuation">:</span><span class="token string">'mapbox://mapbox.mapbox-terrain-v2'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'source-layer'</span><span class="token punctuation">:</span><span class="token string">'contour'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>当且仅当地图数据源加载之后（包括地图样式），上述代码会使用map.on(‘load’, function() { 来运行map.addLayer。立即运行map.addLayer会导致错误，因为addLayer将在样式上添加一个图层，而目标样式尚未加载成功。  </p>
<p>另外还有两种不同的方法改变地图位置：jumpTo 和 easeTo.jumpTo和老式的地图导航工具类似：能够即刻显示另一个位置。easeTo很棒：能够智能地显示缩放、方位角、倾斜度等数值，方便记录地图的详细移动情况。  </p>
<blockquote>
<p>给地图添加数据  </p>
</blockquote>
<p>可使用addLayer()方法将数据作为图层添加到地图中。addLayer将对象视作包括id（由用户创建）和type属性的参数。添加图层时，需要提供source，令渲染器能够使用数据去绘图，可以选择指定layout和 paint属性，告诉渲染器如何进行绘制。  </p>
<blockquote>
<p>添加图层数据源（source）  </p>
</blockquote>
<p>添加新图层时需要添加数据源。图层数据源包括type和url，意味着所有的图层类型（type）都可以作为远程数据源获取（像 Map 中的style一样）。总共有五种图层类型，每种都有自己的properties:  </p>
<ul>
<li>vector tiles</li>
<li>raster tiles</li>
<li>GeoJSON</li>
<li>image</li>
<li>video</li>
</ul>  

<p>矢量数据源同样需要包含一个source-layer，需使用来自矢量文件数据源的图层名称（一般是初始文件的名称）。示例：  </p>
<pre class="line-numbers language-html"><code class="language-html">map.on('load', function() {
  map.addLayer({
    id:'rpd_parks',
    type:'fill',
    source:{
      type:'vector',
      url:'mapbox://mapbox.3o7ubwm8'
    },
    'source-layer':'RPD_Parks'
  });
});
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>图层的数据样式  </p>
</blockquote>
<p>图层包含两个子属性来完成数据样式的添加：Paint 和 layout.用于<font color="red">明确如何渲染地图数据</font>。<br>Layout属性指渲染位置和可见性，应用于渲染过程的早期阶段。<br>paint指更精细的渲染样式，如不透明度、颜色和翻译。不需要大量处理，在后期阶段进行渲染。  </p>
<p>下列代码展示了如何往地图中添加图层，将公园部分填充为绿色。  </p>
<pre class="line-numbers language-html"><code class="language-html">map.on('load', function() {
  map.addLayer({
    id:'rpd_parks',
    type:'fill',
    source:{
      type:'vector',
      url:'mapbox://mapbox.3o7ubwm8'
    },
    'source-layer':'RPD_Parks',
    layout:{
      visibility:'visible'
    },
    paint:{
      'fill-color':'rgba(61,153,80,0.55)'
    }
  });
});
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="获取地图鼠标点击处的经纬度坐标"><a href="#获取地图鼠标点击处的经纬度坐标" class="headerlink" title="获取地图鼠标点击处的经纬度坐标"></a>获取地图鼠标点击处的经纬度坐标</h3><pre class="line-numbers language-html"><code class="language-html">var accessToken='pk.eyJ1Ijoibmltcm9kNyIsImEiOiJkNkw1WWRnIn0.pnQn9P2nbHyhKf2FY_XJog';  
L.mapbox.accessToken = accessToken;  

var click = document.getElementById('click'); //??? 

var map = L.mapbox.map('map', 'nimrod7.k4adg5mg').
setView([51.492842, -0.131874], 16)

map.on('click', function(e) {
    var latlong = e.latlng.lng + ',' + e.latlng.lat;
});<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="TileMill"><a href="#TileMill" class="headerlink" title="TileMill"></a>TileMill</h3><p>TileMill is a standalone application that helps us add various layers of (map or vector) data,write CartoCSS, preview the results, and finally export the tiles:<br>To better understand how it works, we will explain the workflow to create, customize, and publish our own custom-styled map.<br>(TileMill工作流程：创建，自定义样式，发布自定义样式的地图)<br>这个工具比较老了，正在被Mapbox Studio取代。  </p>
<h3 id="Mapbox-Studio"><a href="#Mapbox-Studio" class="headerlink" title="Mapbox Studio"></a>Mapbox Studio</h3><p>Mapbox Studio支持矢量数据vector data。<br>We can use Mapbox Streets as a source; this provides us with the vector data required to<br>build a map. We can also select one of the other sources of Mapbox, such as Mapbox Terrain<br>or Mapbox Satellite. We can even combine all these sources and overlay them one on top of<br>the other to use the features provided by these different sources.  </p>
<p>You may ask, what if I want to import and use my custom data and then overlay it on top<br>of these maps? Well, this is easy too. You can import your own data into Mapbox Studio<br>by converting data from traditional formats, such as those supported by TileMill. Once it is<br>imported, you can then upload it to your Mapbox account, and it will immediately become<br>available for use as a source in Mapbox Studio. It can then be overlaid on top of other map<br>data  </p>
<p>Mapbox Studio works with vector tiles, and because of this, we do not need to export the<br>resulting styled map in separate tiles. With Mapbox Studio, we will simply upload our own<br>custom-created map into our Mapbox account—just like that! We don’t have the hassle of<br>waiting for hours for the tiles to be exported, neither do we need tons of hard drive space, and<br>we are not required to have a high upload speed in order for the upload to be completed in<br>reasonable time. The whole process is nearly instantaneous.  </p>
<p>In spite of the importing and exporting capabilities of Mapbox Studio and the differences from<br>TileMill in the technologies that it uses, such as the vector tiles, we still find a CartoCSS editor,<br>and we can style our map using CartoCSS just as with TileMill  </p>
<p>Another handy feature of Mapbox Studio is the ability to automatically adapt to high-resolution<br>displays (retina displays). In the case of TileMill, we need to export a separate double-sized<br>tileset to use with these displays, causing the exported time, hard drive space, and upload<br>time to double  </p>
<p>Mapbox Studio provides us with all the typography that we should need. It comes bundled<br>with 300 professional quality fonts to use on the maps.  </p>
<h3 id="CartoCSS"><a href="#CartoCSS" class="headerlink" title="CartoCSS"></a>CartoCSS</h3><p>CartoCSS is a powerful stylesheet-like language powering TileMill and Mapbox. It’s extremely<br>powerful and only limited by our imagination. If you are familiar with CSS for the Web, you will<br>feel right at home when you start working with CartoCSS.  </p>
<pre class="line-numbers language-html"><code class="language-html">[zoom &lt; 16] {
    #sf-lines[highway="motorway"] {
     line-width: 5;
    }  
}

#countries {
 polygon-pattern-file: 
 url("http://www.mysite.com/pattern01.png");
}

#countries {
 text-name: [name];
 text-size: 16;
 text-fill: @text;
 text-face-name: "Arial Bold";
 text-halo-radius: 1;
 text-halo-fill: #AC8812;
}


#sf-lines 代表图层的名字
[highway="motorway"],表示which means that we want to find the highway feature in this layer and select all the motorways
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Styling-a-map-with-TileMill（工作流程）"><a href="#Styling-a-map-with-TileMill（工作流程）" class="headerlink" title="Styling a map with TileMill（工作流程）"></a>Styling a map with TileMill（工作流程）</h3><ol>
<li>Download, or generate using GIS software, the map data required for the map  </li>
<li>Create a new TileMill project by clicking on New project.  </li>
<li>Go to the Layers palette, click on Add Layer, and import the data into TileMill.  </li>
<li>Style the map using CartoCSS.  </li>
</ol>
<h2 id="REST-Call-Mapbox-Services"><a href="#REST-Call-Mapbox-Services" class="headerlink" title="REST Call Mapbox Services"></a>REST Call Mapbox Services</h2><p>Every other API and functionality provided by Mapbox, such as the JavaScript API or Mapbox.js, is based on services. It uses GET REST calls to fetch the data you require from Mapbox servers.  </p>
<p>REST services are based on HTTP verbs to perform certain actions, such as reading, creating,updating, and deleting records. GET requests are used to read data from the server; PUT requests are used usually to update data; POST requests are used to create a new record; and DELETE requests are used to delete a record. The Mapbox API is a read-only one, so we only have access to GET requests to read data.  </p>
<p>To get access to the services, we will need an access token. Using an access token, Mapbox knows which user is requesting data, which services are available to this user, and the bandwidth he/she uses.  </p>
<p>The most common formats returned by REST services are XML (Extensible Markup Language) and JSON (JavaScript Object Notation)，XML used to rule the world, but most services these days use JSON, which is faster to submit<br>and easier to process and read. Mapbox services, at the moment, support only the JSON format。  </p>
<h3 id="访问自定义瓦片的服务"><a href="#访问自定义瓦片的服务" class="headerlink" title="访问自定义瓦片的服务"></a>访问自定义瓦片的服务</h3><p>访问自己自定义地图的瓦片服务，以下是对Mapbox Service请求结构的分析（Get请求）  </p>
<p>自己地图的自定义瓦片服务的请求格式为  </p>
<pre class="line-numbers language-shell"><code class="language-shell">/{z}/{x}/{y}.{format}
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>完整请求如下  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/{mapid}/{z}/{x}/{y}.{format}?access_token=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>your</span> <span class="token attr-name">access</span> <span class="token attr-name">token</span><span class="token punctuation">></span></span>  


"http://api.tiles.mapbox.com"  
All requests to Mapbox services must begin with http://api or https://api;  
then, we tell the services that we are interested in fetching individual .tiles.

"v4"  
This is the version number of the API. This ensures that your app doesn't break  
if the Mapbox team updates the API  

"MapID"  
Replace this parameter with your Map ID. Each map has a unique Map ID  
that needs to be referenced here in order to access our styled tiles  

"z/x/y"  
These are integers with the coordinates of the specific tile. They are not  
latitude and longitude coordinates (which are two doubles, anyway), but these are  
coordinates based on the XYZ tiling scheme. The z parameter is the zoom level, while  
x and y are the tile numbers in the coordinate.  

"format"  
You can choose the format of the tiles. Acceptable formats are PNG,  
from 16 colors to 256 colors, and JPG, with compression levels 60, 70, and 80n. The  
format can be prefixed with @2x for retina display  

"access_token=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>your</span> <span class="token attr-name">access</span> <span class="token attr-name">token</span><span class="token punctuation">></span></span>:"  
Finally, you need to supply your access token.  

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="获取静态图片"><a href="#获取静态图片" class="headerlink" title="获取静态图片"></a>获取静态图片</h3><ol>
<li>根据mapID、经度、纬度、缩放等级、图片宽度、图片高度、图片格式、accessToken、构造HTTP(GET)请求。  </li>
<li>在REST客户端(如浏览器)粘贴请求URL访问服务，获取静态图片。  </li>
</ol>
<p>以下是对Mapbox Service请求结构的分析，大部分与上一个服务的请求类似，不同的是，这里我们提供了经度、纬度和缩放等级，而不是上一请求里的瓦片信息（z/x/y）  </p>
<p>请求静态图片的格式如下</p>
<pre class="line-numbers language-shell"><code class="language-shell">/{lon},{lat},{z}/{width}x{height}.{format}

"lon": 经度，-180至180  
"lat": 纬度，-85至85  
"z": 缩放等级，1至19  
"width": 图片的像素宽度，最大值1280px  
"height" 图片的像素高度，最大值1280px  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>完整请求如下  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/nimrod7.k4adg5mg/{lon},{lat},{z}/{width}x{height}.{format}?access_token=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>your</span> <span class="token attr-name">access</span> <span class="token attr-name">token</span><span class="token punctuation">></span></span>  
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="在静态图片上添加标记"><a href="#在静态图片上添加标记" class="headerlink" title="在静态图片上添加标记"></a>在静态图片上添加标记</h3><p>Mapbox offers the ability to add markers to your static maps. The format of the requests has to be similar to the following:  </p>
<pre class="line-numbers language-shell"><code class="language-shell">/{size}-{icon}+{color}({lon},{lat})

{size}:标记的大小  
pin-s代表small，pin-m代表medium，pin-l代表large  
{icon}:标记的图标  
Mapbox Service提供了一系列icons  
{color}：标记点的颜色 in hex format. It can be three or six digits.  
({lon},{lat})：标记点的经度、纬度  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>完整的请求服务如下  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/nimrod7.k4adg5mg/pin-l-danger+f00(-6.240,53.348)/-6.245079,53.344731,14/800x600.png?access_token=pk.eyJ1Ijoibmltcm9kNyIsImEiOiJkNkw1WWRnIn0.pnQn9P2nbHyhKf2FY_XJog
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="根据地址获得经纬度坐标"><a href="#根据地址获得经纬度坐标" class="headerlink" title="根据地址获得经纬度坐标"></a>根据地址获得经纬度坐标</h3><p>根据地址获得经纬度坐标，这个过程就是地理编码(geocoding)  </p>
<pre class="line-numbers language-shell"><code class="language-shell">{dataset}/{lon},{lat}.json?access_token=<your access token>  

http://api.tiles.mapbox.com/v4/geocode/{master-source}/{query}.json?access_token=<your access token>  

{master-source}： 值如下  
mapbox.places-v1: This sends back every detail, including address, province,postcode, and so on.
mapbox.places-country-v1:  This sends back just the countries.  
mapbox.places-province-v1: This sends back the provinces.  
mapbox.places-postcode-v1: This sends back the postcodes.  
mapbox.places-city-v1: This sends back places, such as cities  
mapbox.places-address-v1: This sends back addresses.  


{query} 值取决你查询哪里
比如你要查询国家Ireland里城市Dublin，这个值为 Dublin+Ireland  
比如你要查询国家Ireland里城市Dublin的街道 O'Connel street，这个值为OConnel+Dublin+Ireland  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li>通过master source构造Get请求  </li>
<li>在REST客户端(如浏览器)粘贴请求URL访问服务  </li>
<li>获得结果json  </li>
</ol>
<p>完整请求如下  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/Dublin+Ireland.json?access_token=pk.eyJ1Ijoibmltcm9kNyIsImEiOiJkNkw1WWRnIn0.pnQn9P2nbHyhKf2FY_XJog  
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>获得结果json参考如下  </p>
<pre class="line-numbers language-html"><code class="language-html">{
 "id": "city.10560743",
 "type": "Feature",
 "text": "Dublin",
 "place_name": "Dublin, Dublin City, Ireland",
 "relevance": 0.48,
 "center": [
 -6.300364,
 53.333637
 ]
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="根据经纬度坐标获得地址"><a href="#根据经纬度坐标获得地址" class="headerlink" title="根据经纬度坐标获得地址"></a>根据经纬度坐标获得地址</h3><p>根据经纬度坐标获得地址，这个过程就是逆编码(Reverse geocoding或forward geocoding)  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/geocode/{index}/{lon},{lat}.json?access_token=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>your</span> <span class="token attr-name">access</span> <span class="token attr-name">token</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li>通过master source构造Get请求  </li>
<li>在REST客户端(如浏览器)粘贴请求URL访问服务  </li>
<li>获得结果json  </li>
</ol>
<p>完整请求如下  </p>
<pre class="line-numbers language-html"><code class="language-html">http://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/-6.348457,53.712829.json?access_token=pk.eyJ1Ijoibmltcm9kNyIsImEiOiJkNkw1WWRnIn0.pnQn9P2nbHyhKf2FY_XJog
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Hello-MapboxGL"><a href="#Hello-MapboxGL" class="headerlink" title="Hello MapboxGL"></a>Hello MapboxGL</h2><p>在页面引入MapboxGL脚本库和样式库</p>
<pre class="line-numbers language-html"><code class="language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>执行上述引入脚本后即创建了mapboxgl对象，通过它可以使用MapboxGL的全部功能。<br>使用之前，需要先设置mapboxgl.accessToken。access tokens（访问令牌）可以在用户信息页查看或者创建令牌</p>
<h3 id="mapboxgl获取鼠标位置的坐标"><a href="#mapboxgl获取鼠标位置的坐标" class="headerlink" title="mapboxgl获取鼠标位置的坐标"></a>mapboxgl获取鼠标位置的坐标</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>
     mapboxgl获取鼠标位置的坐标
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0, maximum-scale<span class="token punctuation">=</span>1.0, user-scalable<span class="token punctuation">=</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cache-Control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache, no-store, must-revalidate<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pragma<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Expires<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector">body </span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token selector"><span class="token id">#map</span> </span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> 
      <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token id">#info</span> </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#222</span><span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>map<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>info<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">

mapboxgl<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    container<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
    style<span class="token punctuation">:</span> <span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
    center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    zoom<span class="token punctuation">:</span> <span class="token number">12</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span>       <span class="token comment" spellcheck="true">/* innerHTML 属性设置或返回表格行的开始和结束标签之间的 HTML  */</span>
        <span class="token comment" spellcheck="true">// e.point is the x, y coordinates of the mousemove event relative</span>
        <span class="token comment" spellcheck="true">// to the top-left corner of the map</span>
        JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>point<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;br />'</span> <span class="token operator">+</span>
        <span class="token comment" spellcheck="true">// e.lngLat is the longitude, latitude geographical position of the event</span>
        JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>lngLat<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/* JSON.stringify() 方法可以将任意的 JavaScript 值序列化成 JSON 字符串 */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="可拖拽的标记"><a href="#可拖拽的标记" class="headerlink" title="可拖拽的标记"></a>可拖拽的标记</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>
     添加可拖拽的标记
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0, maximum-scale<span class="token punctuation">=</span>1.0, user-scalable<span class="token punctuation">=</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cache-Control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache, no-store, must-revalidate<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pragma<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Expires<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector">body </span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token selector"><span class="token id">#map</span> </span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> 
      <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token id">#info</span> </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#222</span><span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>map<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>info<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>




<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">

 <span class="token keyword">var</span> coordinates <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mapboxgl<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    container<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
    style<span class="token punctuation">:</span> <span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
    center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    zoom<span class="token punctuation">:</span> <span class="token number">12</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    draggable<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
marker<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
marker<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> lngLat <span class="token operator">=</span> marker<span class="token punctuation">.</span><span class="token function">getLngLat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  coordinates<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
  coordinates<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span>
    <span class="token string">"Longitude: "</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lng <span class="token operator">+</span> <span class="token string">"&lt;br />Latitude: "</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lat<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

    marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"dragstart"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动结束</span>
    marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"drag"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动中</span>
    marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"dragend"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动开始</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="自带popup"><a href="#自带popup" class="headerlink" title="自带popup"></a>自带popup</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>
     mapbox
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0, maximum-scale<span class="token punctuation">=</span>1.0, user-scalable<span class="token punctuation">=</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cache-Control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache, no-store, must-revalidate<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pragma<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Expires<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector">body </span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token selector"><span class="token id">#map</span> </span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> 
      <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token id">#info</span> </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#222</span><span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>map<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>info<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>




<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">

 <span class="token keyword">var</span> coordinates <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mapboxgl<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    container<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
    style<span class="token punctuation">:</span> <span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
    center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    zoom<span class="token punctuation">:</span> <span class="token number">12</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    draggable<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
marker<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
marker<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> popup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Popup</span><span class="token punctuation">(</span><span class="token punctuation">{</span> closeOnClick<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">114.297462</span><span class="token punctuation">,</span> <span class="token number">30.5614976</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setHTML</span><span class="token punctuation">(</span><span class="token string">'&lt;h1>Hello World!&lt;/h1>'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 


</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="根据GeoJSON创建点线面及定位操作"><a href="#根据GeoJSON创建点线面及定位操作" class="headerlink" title="根据GeoJSON创建点线面及定位操作"></a>根据GeoJSON创建点线面及定位操作</h3><p>报错，待调试</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>
     mapbox
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0, maximum-scale<span class="token punctuation">=</span>1.0, user-scalable<span class="token punctuation">=</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cache-Control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache, no-store, must-revalidate<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pragma<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Expires<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector">body </span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token selector"><span class="token id">#map</span> </span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> 
      <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token id">#info</span> </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#222</span><span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>map<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>info<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>




<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">

 <span class="token keyword">var</span> coordinates <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mapboxgl<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> map<span class="token punctuation">,</span> graphicLayer<span class="token punctuation">;</span>


 map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     container<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
     style<span class="token punctuation">:</span> <span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
     center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.064013</span><span class="token punctuation">,</span> <span class="token number">30.54742</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     zoom<span class="token punctuation">:</span> <span class="token number">12.64</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>NavigationControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'top-left'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
 <span class="token keyword">var</span> geojsonPoints <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
            <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"天府三街"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
                    <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.06303023033792</span><span class="token punctuation">,</span> <span class="token number">30.54675753000589</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                  <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"天府五街"</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
                      <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.06056505865428</span><span class="token punctuation">,</span> <span class="token number">30.537889923501893</span><span class="token punctuation">]</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>

            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> geojsonPolygon <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
            <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                  <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"id"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
                      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"银泰城"</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">104.05734538204854</span><span class="token punctuation">,</span> <span class="token number">30.542126961366336</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.05733923297134</span><span class="token punctuation">,</span> <span class="token number">30.540628203046936</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06044451507631</span><span class="token punctuation">,</span> <span class="token number">30.540659979072146</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06041991880102</span><span class="token punctuation">,</span> <span class="token number">30.542142849135033</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.05734538204854</span><span class="token punctuation">,</span> <span class="token number">30.542126961366336</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Polygon"</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> geojsonLine <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
            <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                  <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"天府大道"</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"LineString"</span><span class="token punctuation">,</span>
                      <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                          <span class="token punctuation">[</span><span class="token number">104.06913702979529</span><span class="token punctuation">,</span> <span class="token number">30.546739585129146</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">104.06907454389955</span><span class="token punctuation">,</span> <span class="token number">30.54592791405807</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">104.06912588372228</span><span class="token punctuation">,</span> <span class="token number">30.544417223111353</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">104.06914299695103</span><span class="token punctuation">,</span> <span class="token number">30.542508560460377</span><span class="token punctuation">]</span>
                      <span class="token punctuation">]</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//仅初始化点类型</span>
        <span class="token keyword">function</span> <span class="token function">initPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">'geodataPoint'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'geojson'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> geojsonPoints <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'pointlayer'</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'circle'</span><span class="token punctuation">,</span>
                <span class="token string">'source'</span><span class="token punctuation">:</span> <span class="token string">"geodataPoint"</span><span class="token punctuation">,</span>
                <span class="token string">'paint'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// make circles larger as the user zooms from z12 to z22</span>
                    <span class="token string">'circle-radius'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">'base'</span><span class="token punctuation">:</span> <span class="token number">1.75</span><span class="token punctuation">,</span>
                        <span class="token string">'stops'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment" spellcheck="true">//'circle-radius':13,</span>
                    <span class="token string">"circle-color"</span><span class="token punctuation">:</span> <span class="token string">"#B42222"</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//仅初始化线类型</span>
        <span class="token keyword">function</span> <span class="token function">initLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">'geodataLine'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'geojson'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> geojsonLine <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'linelayer'</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token string">'source'</span><span class="token punctuation">:</span> <span class="token string">"geodataLine"</span><span class="token punctuation">,</span>
                <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                    <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#BF93E4"</span><span class="token punctuation">,</span>
                    <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">5</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//仅初始化面类型</span>
        <span class="token keyword">function</span> <span class="token function">initPolygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">'geodataPolygon'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'geojson'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> geojsonPolygon <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"polygonlayer"</span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"fill"</span><span class="token punctuation">,</span>
                <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"geodataPolygon"</span><span class="token punctuation">,</span>
                <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"fill-color"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span>
                    <span class="token string">"fill-opacity"</span><span class="token punctuation">:</span> <span class="token number">0.4</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token comment" spellcheck="true">/* initPoints();
        initLines();
        initPolygon();
        */</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token comment" spellcheck="true">// 点击 面 图层的符号，显示信息</span>
map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'polygonlayer'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//map.flyTo({ center: e.features[0].geometry.coordinates });</span>
            <span class="token comment" spellcheck="true">//var boundingBox = getPolygonBoundingBox(e.features[0]);</span>
            <span class="token comment" spellcheck="true">//map.fitBounds(boundingBox, { padding: 200 });</span>
            <span class="token keyword">var</span> coordinates <span class="token operator">=</span> e<span class="token punctuation">.</span>lngLat<span class="token punctuation">;</span>
            <span class="token keyword">var</span> description <span class="token operator">=</span> e<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"&lt;br/>"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>lngLat<span class="token punctuation">.</span>lng <span class="token operator">-</span> coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> e<span class="token punctuation">.</span>lngLat<span class="token punctuation">.</span>lng <span class="token operator">></span> coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token number">360</span> <span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//防止数据越界</span>

            <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Popup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHTML</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//点击 线 图层的符号，显示信息</span>
        map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'linelayer'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> coordinates <span class="token operator">=</span> e<span class="token punctuation">.</span>lngLat<span class="token punctuation">;</span>
            <span class="token keyword">var</span> description <span class="token operator">=</span> e<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"&lt;br/>"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>lngLat<span class="token punctuation">.</span>lng <span class="token operator">-</span> coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> e<span class="token punctuation">.</span>lngLat<span class="token punctuation">.</span>lng <span class="token operator">></span> coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token number">360</span> <span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//防止数据越界</span>

            <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Popup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHTML</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token comment" spellcheck="true">//定位到某一个面</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnZoom2FirstPolygon"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"已经没有多边形面Feature了，至少有一条才能定位"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> boundingBox <span class="token operator">=</span> <span class="token function">getPolygonBoundingBox</span><span class="token punctuation">(</span>geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>boundingBox<span class="token punctuation">,</span> <span class="token punctuation">{</span> padding<span class="token punctuation">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//定位到某一条线</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnZoom2FirstLine"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>geojsonLine<span class="token punctuation">.</span>features<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"已经没有线Feature了，至少有一条才能定位"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// Geographic coordinates of the LineString</span>
            <span class="token keyword">var</span> coordinates <span class="token operator">=</span> geojsonLine<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// Pass the first coordinates in the LineString to `lngLatBounds` &amp;</span>
            <span class="token comment" spellcheck="true">// wrap each coordinate pair in `extend` to include them in the bounds</span>
            <span class="token comment" spellcheck="true">// result. A variation of this technique could be applied to zooming</span>
            <span class="token comment" spellcheck="true">// to the bounds of multiple Points or Polygon geomteries - it just</span>
            <span class="token comment" spellcheck="true">// requires wrapping all the coordinates with the extend method.</span>
            <span class="token keyword">var</span> bounds <span class="token operator">=</span> coordinates<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>bounds<span class="token punctuation">,</span> coord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> bounds<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>coord<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>LngLatBounds</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>bounds<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                padding<span class="token punctuation">:</span> <span class="token number">20</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//定位到某一个点</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnZoom2FirstPoint"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>geojsonPoints<span class="token punctuation">.</span>features<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"已经没有线Feature了，至少有一点才能定位"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// Geographic coordinates of the LineString</span>
            <span class="token keyword">var</span> coordinates <span class="token operator">=</span> geojsonPoints<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">;</span>
            <span class="token keyword">var</span> xy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>LngLat</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>center<span class="token punctuation">:</span>xy<span class="token punctuation">,</span>  zoom<span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">getPolygonBoundingBox</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// bounds [xMin, yMin][xMax, yMax]</span>
            <span class="token keyword">var</span> bounds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> polygon<span class="token punctuation">;</span>
            <span class="token keyword">var</span> latitude<span class="token punctuation">;</span>
            <span class="token keyword">var</span> longitude<span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// Polygon coordinates[0][nodes]</span>
                    polygon <span class="token operator">=</span> feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// Polygon coordinates[poly][0][nodes]</span>
                    polygon <span class="token operator">=</span> feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> polygon<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    longitude <span class="token operator">=</span> polygon<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    latitude <span class="token operator">=</span> polygon<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> longitude <span class="token operator">?</span> bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> longitude<span class="token punctuation">;</span>
                    bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> longitude <span class="token operator">?</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> longitude<span class="token punctuation">;</span>
                    bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> latitude <span class="token operator">?</span> bounds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> latitude<span class="token punctuation">;</span>
                    bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> latitude <span class="token operator">?</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> latitude<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> bounds<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token comment" spellcheck="true">//操作mapboxgl中GeoJSON的数据，更新Source来实现图层数据的新增、修改、删除</span>
   document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnAddData"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                    <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"id"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"香年广场"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">104.06580881154582</span><span class="token punctuation">,</span> <span class="token number">30.545463011873835</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06579777330768</span><span class="token punctuation">,</span> <span class="token number">30.54478171727888</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06711500077967</span><span class="token punctuation">,</span> <span class="token number">30.544753197865305</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06711132135428</span><span class="token punctuation">,</span> <span class="token number">30.54549153107891</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.06580881154582</span><span class="token punctuation">,</span> <span class="token number">30.545463011873835</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Polygon"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>

            map<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token string">'geodataPolygon'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
               geojsonPolygon
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnGetDataAndUpdate"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span>geojsonPolygon<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            map<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token string">'geodataPolygon'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
                geojsonPolygon
            <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btnDeleteAll"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            geojsonPolygon<span class="token punctuation">.</span>features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token string">'geodataPolygon'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>
                geojsonPolygon
            <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="根据GeoJSON创建点"><a href="#根据GeoJSON创建点" class="headerlink" title="根据GeoJSON创建点"></a>根据GeoJSON创建点</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>
     mapbox
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0, maximum-scale<span class="token punctuation">=</span>1.0, user-scalable<span class="token punctuation">=</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cache-Control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache, no-store, must-revalidate<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Pragma<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-cache<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Expires<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">
    <span class="token selector">body </span><span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token selector"><span class="token id">#map</span> </span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> 
      <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token id">#info</span> </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#222</span><span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>map<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>info<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>




<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">


mapboxgl<span class="token punctuation">.</span>accessToken <span class="token operator">=</span> <span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>





<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     container<span class="token punctuation">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
     style<span class="token punctuation">:</span> <span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
     center<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.06303023033792</span><span class="token punctuation">,</span> <span class="token number">30.54675753000589</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     zoom<span class="token punctuation">:</span> <span class="token number">12</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>NavigationControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'top-left'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


 <span class="token keyword">var</span> geojsonPoints <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
      <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
          <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
          <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"66666666666"</span><span class="token punctuation">,</span>
              <span class="token string">"icon"</span><span class="token punctuation">:</span><span class="token string">"monument"</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
              <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.06303023033792</span><span class="token punctuation">,</span> <span class="token number">30.54675753000589</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
            <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"99999"</span><span class="token punctuation">,</span>
              <span class="token string">"icon"</span><span class="token punctuation">:</span><span class="token string">"harbor"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
                <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">104.06056505865428</span><span class="token punctuation">,</span> <span class="token number">30.537889923501893</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

      <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">initPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">'geodataPoint'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'geojson'</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> geojsonPoints <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'geodataPoint'</span><span class="token punctuation">,</span>
          <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'symbol'</span><span class="token punctuation">,</span>
          <span class="token string">'source'</span><span class="token punctuation">:</span> <span class="token string">"geodataPoint"</span><span class="token punctuation">,</span>
          <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"icon-image"</span><span class="token punctuation">:</span> <span class="token string">"{icon}-15"</span><span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">/* 图标图像 */</span>
            <span class="token string">"text-field"</span><span class="token punctuation">:</span> <span class="token string">"{title}"</span><span class="token punctuation">,</span>     <span class="token comment" spellcheck="true">/* 使用text标签显示的值，Feature属性使用{域名}格式*/</span>
            <span class="token string">"text-font"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"Open Sans Semibold"</span><span class="token punctuation">,</span> <span class="token string">"Arial Unicode MS Bold"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">/* 文本字体 */</span>
            <span class="token string">"text-offset"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment" spellcheck="true">/* 该属性表示文本偏移锚点的距离，正值表示向右和向下，负值表示向左和向上 */</span>
            <span class="token string">"text-anchor"</span><span class="token punctuation">:</span> <span class="token string">"top"</span>         <span class="token comment" spellcheck="true">/* 该属性设置文本中最接近锚点的部分，top表示文本的顶端放置到最接近锚点的位置 */</span>
          <span class="token punctuation">}</span>

      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>



 map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">/* on(type,callback)为type事件添加监听器，callback是响应函数*/</span>
  <span class="token function">initPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Mapboxgl-Marker的删除"><a href="#Mapboxgl-Marker的删除" class="headerlink" title="Mapboxgl Marker的删除"></a>Mapboxgl Marker的删除</h2><pre class="line-numbers language-html"><code class="language-html">$( ".mymark" ).remove();
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Mapboxgl动态设置图层属性"><a href="#Mapboxgl动态设置图层属性" class="headerlink" title="Mapboxgl动态设置图层属性"></a>Mapboxgl动态设置图层属性</h2><pre class="line-numbers language-html"><code class="language-html">  let layerKey = 'xjq_fill'
  let layer = this.map.getLayer(layerKey)
  if (layer) {
    this.map.setPaintProperty(
      layerKey,
      'fill-color',
      this.exProps.coverColor
    )
  } else {
    this.map.addLayer({
      id: layerKey,
      type: 'fill',
      source: sourceKey,
      paint: {
        'fill-color': this.exProps.coverColor
      }
    })
  }
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            
            
            
            <div class="reprint1">
                <p>
                    <span class="reprint1-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://127.0.0.1/diary" class="b-link-green">车舟慢</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/diary/2021/08/22/diary-20210822-1/" class="b-link-green">Mapbox GL入门</a>
                </p>
            </div>

        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }
	
	/*zs shuai*/
	#vcomments{
		display:none;
	}
	
    /* valine 评论框增加背景图片 */
    #vcomments textarea {
        box-sizing: border-box;
        background: url("") 100% 100% no-repeat;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    /* 修复评论第一行位置错位 */
    .v .vlist .vcard {
    padding-top: 2.5em !important ;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="/libs//libs/jQuery-emoji/dist/css/jquery.emoji.css">
<script src="/libs//libs/jQuery-emoji/dist/js/jquery.emoji.min.js"></script>
<script src="/libs//libs/jQuery-emoji/dist/js/emoji.list.js"></script> -->
<script>
    new Valine({
        el: '#vcomments',
        appId: '2Kc1yifl00dRA6CYQxICVIe4-MdYXbMMI',
        appKey: 'xni6ILbDL2WVE4HDucMuDtx7',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: '',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go ヾﾉ≧∀≦)o ',

    });

//     function parse_emoji() {
//     jQuery(".vcontent").emojiParse({
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists   // 注：详见 js/emoji.list.js
//     });
//   }
  
//   setTimeout(function() {
//     // jQuery emoji 解析
//     parse_emoji();
//     // jquery emoji 初始化
//     jQuery(".veditor").emoji({
//       showTab: true,
//       animation: 'slide',
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists  // 注：详见 js/emoji.list.js
//     });
//     jQuery(".vmore").on("click", function() {
//       setTimeout(function() {
//         parse_emoji();
//       }, 500);
//     });
//   }, 800)

</script>
    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/diary/2021/08/27/diary-20210826-1/">
                    <div class="card-image">
                        
                        
                        <img src="/diary/medias/featureimages/24.jpg" class="responsive-img" alt="Cesium加载矢量数据">
                        
                        <span class="card-title">Cesium加载矢量数据</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            矢量图与栅格图的区别地理信息系统中，矢量和栅格是两种主要的空间数据结构。它们的数据来源、结构和格式都不同。最大不同是，栅格就是一个规则的阵列（matrix），其中各个像元（pix）互不影响；而矢量图是由一些个坐标和由这些坐标组成的线、面、体
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2021-08-27
                        </span>
                        <span class="publish-author">
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/diary/tags/Cesium/" target="_blank">
                        <span class="chip bg-color">Cesium</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/diary/2021/08/10/diary-20210809-2/">
                    <div class="card-image">
                        
                        
                        <img src="/diary/medias/featureimages/10.jpg" class="responsive-img" alt="ThreeJS入门">
                        
                        <span class="card-title">ThreeJS入门</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            基于threejs的场景编辑器.rar
什么是three.js相对于Flash、Flex、Silverlight等富客户端，WebGL之ThreeJS通过OpenGLES2.0，WebGL可以为Canvas提供硬件3D加速渲染，这样Web开
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2021-08-10
                            </span>
                        <span class="publish-author">
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/diary/tags/three-js/" target="_blank">
                        <span class="chip bg-color">three.js</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 车舟慢<br />'
            + '作者: <br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/diary/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


        <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            

            <br>
            <span id="sitetime"></span><span class="my-face">ღゝ◡╹)ノ♡</span>
            <br>

            

            
            <!--
            
			
                &nbsp; | &nbsp;字数统计:&nbsp;
    <span class="white-color">650.5k</span> 字  
			
            
			
			-->

            
            <br>

        </div>

        <div class="col s12 m4 l4 social-link social-statis">

 
    <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=617641594@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>






    <a href="http://wpa.qq.com/msgrd?v=3&uin=617641594&site=qq&menu=yes" class="tooltipped" target="_blank" data-tooltip="访问我的QQ空间" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>




<!--

    <a href="/diary/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>

--></div>

    </div>
</footer>

<div class="progress-bar"></div>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();

        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */

        var t1 = Date.UTC(2020, 5, 1, 00, 00, 00); //北京时间2019-8-1 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes *
            minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已坚持运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours +
            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒" ;
    } /*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>






        <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>
<script src="/diary/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/diary/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
        <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


        <script src="/diary/libs/materialize/materialize.min.js"></script>
        <script src="/diary/libs/masonry/masonry.pkgd.min.js"></script>
        <script src="/diary/libs/aos/aos.js"></script>
        <script src="/diary/libs/scrollprogress/scrollProgress.min.js"></script>
        <script src="/diary/libs/lightGallery/js/lightgallery-all.min.js"></script>
        <script src="/diary/js/matery.js"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->



        
            <script src="/diary/libs/others/clicklove.js"></script>
        

        

        
        <script type="text/javascript">
            var OriginTitile = document.title,
                st;
            document.addEventListener("visibilitychange", function () {
                document.hidden ? (document.title = "看不见我🙈~看不见我🙈~", clearTimeout(st)) : (document.title =
                    "(๑•̀ㅂ•́) ✧被发现了～", st = setTimeout(function () {
                        document.title = OriginTitile
                    }, 3e3))
            })
        </script>

       
        

        
        

    
        

    
        

        

        
        

        
        

        
        
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 992) {
                document.write('<script type="text/javascript" src="/diary/libs/background/ribbon-dynamic.js"><\/script>');
            }
            </script>
        

    <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>
</html>