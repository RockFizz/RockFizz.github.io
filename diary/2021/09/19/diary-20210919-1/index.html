<!DOCTYPE HTML>
<html lang="zh-CN">
    


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="MapboxGL在Vue中实践, 车舟慢">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="KeoTn_OFy4ndJwXNmm2gMeQfPhd7alqE9vQDwI32KCY">
    <meta name="description" content="学习MapboxGL如何查看mapboxgl地图里有哪些配置，哪些layers？
查看浏览器调试窗口的network接口抓包用console.log(map)打印地图对象  

地图的所有信息都会写入到map 对象里面，_layers里面记">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>MapboxGL在Vue中实践 | 车舟慢</title>
    <link rel="icon" type="image/png" href="/diary/favicon.png">

    <link rel="stylesheet" type="text/css" href="/diary/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/diary/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/diary/css/my.css">
    
    <style type="text/css">
        
    </style>

    <script src="/diary/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

<link rel="stylesheet" href="/diary/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/diary/css/prism-line-numbers.css" type="text/css"></head>

    <body>

        <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/diary/" class="waves-effect waves-light">
                    
                    <img src="/diary/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">车舟慢</span>
                </a>
            </div>
            


<!-- <a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/diary/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
            
            <i class="fa fa-music"></i>
            
            <span>说说</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/diary/galleries" class="waves-effect waves-light">
            
            <i class="fa fa-photo"></i>
            
            <span>相册</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul> -->

<!-- 支持二级菜单特性  -->
<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right nav-menu">
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/" class="waves-effect waves-light">
              
                <i class="fa fa-home"></i>
              
              <span>首页</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/categories" class="waves-effect waves-light">
              
                <i class="fa fa-bookmark"></i>
              
              <span>分类</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/archives" class="waves-effect waves-light">
              
                <i class="fa fa-archive"></i>
              
              <span>归档</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
              
                <i class="fa fa-music"></i>
              
              <span>说说</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/diary/galleries" class="waves-effect waves-light">
              
                <i class="fa fa-photo"></i>
              
              <span>相册</span>
            </a>

            
      </li>
    

    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/diary/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">车舟慢</div>
        <div class="logo-desc">
            
            雁引愁心去，山衔好月来。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/diary/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/diary/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/diary/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-music"></i>
                
                说说
            </a>
        </li>
        
        <li>
            <a href="/diary/galleries" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-photo"></i>
                
                相册
            </a>
        </li>
        
        
    </ul>

   
   
<!-- 支持二级菜单特性   -->
<!-- <ul class="menu-list mobile-menu-list">
    
        <li class="m-nav-item">
                
                    <a href="/diary/" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-home"></i>
                        
                        首页
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/categories" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-bookmark"></i>
                        
                        分类
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/archives" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-archive"></i>
                        
                        归档
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/demo/shuoshuo" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-music"></i>
                        
                        说说
                    </a>
              
            </li>
        
        <li class="m-nav-item">
                
                    <a href="/diary/galleries" class="waves-effect waves-light">
                        
                        <i class="fa fa-fw fa-photo"></i>
                        
                        相册
                    </a>
              
            </li>
        

        
    </ul> -->

</div>

        </div>

        
    </nav>

</header>

        
<script src="/diary/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/diary/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/diary/medias/featureimages/18.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        MapboxGL在Vue中实践
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/diary/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/diary/tags/three-js/" target="_blank">
                                <span class="chip bg-color">three.js</span>
                            </a>
                        
                            <a href="/diary/tags/MapboxGL/" target="_blank">
                                <span class="chip bg-color">MapboxGL</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>
            
            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-09-19
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                        sean
                    
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        10.3k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        59 分
                    </div>
                    
                
                
                

            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="学习MapboxGL"><a href="#学习MapboxGL" class="headerlink" title="学习MapboxGL"></a>学习MapboxGL</h2><h3 id="如何查看mapboxgl地图里有哪些配置，哪些layers？"><a href="#如何查看mapboxgl地图里有哪些配置，哪些layers？" class="headerlink" title="如何查看mapboxgl地图里有哪些配置，哪些layers？"></a>如何查看mapboxgl地图里有哪些配置，哪些layers？</h3><blockquote>
<p>查看浏览器调试窗口的network接口抓包<br>用console.log(map)打印地图对象  </p>
</blockquote>
<p>地图的所有信息都会写入到map 对象里面，_layers里面记录了所有覆盖在地图上面的图层，里面是一个对象集合，每个对象里面都有layer 的id 、type、layout 、paint 等属性。跟photoshop 一样，canvas 绘制的地图就是一层一层的图层叠加起来的图片，每一层图层都有自己的一些设计，每个图层都有自己指定的图层序号(id）。要修改某个图层只需要知道layer id 就行。  </p>
<pre class="line-numbers language-html"><code class="language-html">//查询所有图层
var layers= map1.getStyle().layers;
console.log(layers);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="Vue中安装MapboxGL"><a href="#Vue中安装MapboxGL" class="headerlink" title="Vue中安装MapboxGL"></a>Vue中安装MapboxGL</h2><p><a href="https://pan.baidu.com/s/1MGIfv8FchcWwFIJfiIAkPg" target="_blank" rel="noopener"> mapboxgl_threejs_20210921.rar </a></p>
<ol>
<li>新建vue-cli项目后安装mapboxgl依赖  </li>
</ol>
<pre class="line-numbers language-html"><code class="language-html">npm install --save mapbox-gl@1.13.1  
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="2">
<li>引入mapboxgl的hellowolrd网页  </li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token keyword">import</span> Mapboxgl <span class="token keyword">from</span> <span class="token string">'mapbox-gl'</span>
<span class="token keyword">import</span> <span class="token string">'mapbox-gl/dist/mapbox-gl.css'</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'HiMapboxgl'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to HiMapboxgl'</span><span class="token punctuation">,</span>
      map<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token function">initmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>     
        Mapboxgl<span class="token punctuation">.</span>accessToken<span class="token operator">=</span><span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          container<span class="token punctuation">:</span><span class="token string">'map'</span><span class="token punctuation">,</span>
          style<span class="token punctuation">:</span><span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
          center<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">114.32391708966355</span><span class="token punctuation">,</span><span class="token number">30.594908665167466</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          zoom<span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
          pitch<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的角度，不写默认是0，取值是0-60度，一般在3D中使用</span>
          bearing<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的初始方向，值是北的逆时针度数，默认是0，即是正北</span>
          antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//抗锯齿，通过false关闭提升性能</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         
        <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           that<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span> draggable<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">114.32391708966355</span><span class="token punctuation">,</span><span class="token number">30.594908665167466</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token comment" spellcheck="true">//marker.on("dragstart", onDragEnd);//鼠标移动结束 </span>
        <span class="token comment" spellcheck="true">//marker.on("drag", onDragEnd);//鼠标移动中 </span>
        marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"dragend"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动开始</span>
        <span class="token keyword">function</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> lngLat <span class="token operator">=</span> marker<span class="token punctuation">.</span><span class="token function">getLngLat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Longitude:"</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lng <span class="token operator">+</span> <span class="token string">"Latitude: "</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lat <span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>   
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
<span class="token selector"><span class="token id">#map</span></span><span class="token punctuation">{</span> 
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>具有一些功能的示例  </li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">z-index</span><span class="token punctuation">:</span><span class="token number">100</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
 <span class="token comment" spellcheck="true">&lt;!-- &lt;div id="customMarker" style="background:url('static/1.png');height: 306px;width: 306px;z-index:50" >&lt;/div>  --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token keyword">import</span> Mapboxgl <span class="token keyword">from</span> <span class="token string">'mapbox-gl'</span>
<span class="token keyword">import</span> <span class="token string">'mapbox-gl/dist/mapbox-gl.css'</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> turf <span class="token keyword">from</span> <span class="token string">'@turf/turf'</span>



<span class="token keyword">const</span> line_json_from<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./320900.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment" spellcheck="true">//const point_json_from=require('./point.json'); </span>

<span class="token keyword">const</span> resolutions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token number">156543.03392800014</span><span class="token punctuation">,</span> <span class="token number">78271.516963999937</span><span class="token punctuation">,</span> <span class="token number">39135.758482000092</span><span class="token punctuation">,</span> <span class="token number">19567.879240999919</span><span class="token punctuation">,</span>
  <span class="token number">9783.9396204999593</span><span class="token punctuation">,</span> <span class="token number">4891.9698102499797</span><span class="token punctuation">,</span> <span class="token number">2445.9849051249898</span><span class="token punctuation">,</span> <span class="token number">1222.9924525624949</span><span class="token punctuation">,</span> <span class="token number">611.49622628137968</span><span class="token punctuation">,</span>
  <span class="token number">305.74811314055756</span><span class="token punctuation">,</span> <span class="token number">152.87405657041106</span><span class="token punctuation">,</span> <span class="token number">76.437028285073239</span><span class="token punctuation">,</span> <span class="token number">38.21851414253662</span><span class="token punctuation">,</span> <span class="token number">19.10925707126831</span><span class="token punctuation">,</span>
  <span class="token number">9.5546285356341549</span><span class="token punctuation">,</span> <span class="token number">4.7773142679493699</span><span class="token punctuation">,</span> <span class="token number">2.3886571339746849</span><span class="token punctuation">,</span> <span class="token number">1.1943285668550503</span><span class="token punctuation">,</span> <span class="token number">0.59716428355981721</span><span class="token punctuation">,</span>
  <span class="token number">0.29858214164761665</span><span class="token punctuation">,</span> <span class="token number">0.149291070823808325</span><span class="token punctuation">,</span> <span class="token number">0.0746455354119041625</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'HiMapboxgl'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to HiMapboxgl'</span><span class="token punctuation">,</span>
      map<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token function">initmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>     
        Mapboxgl<span class="token punctuation">.</span>accessToken<span class="token operator">=</span><span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//空白地图底图，可修改背景色</span>
        <span class="token keyword">var</span> mapStyle <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"BlankBackground"</span><span class="token punctuation">,</span>
            <span class="token string">"sources"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"mapbox"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"vector"</span><span class="token punctuation">,</span>
                    <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"mapbox://mapbox.mapbox-streets-v8"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"sprite"</span><span class="token punctuation">:</span> <span class="token string">"mapbox://sprites/mapbox/dark-v10"</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">//  "glyphs": "mapbox://fonts/mapbox/{fontstack}/{range}.pbf",</span>
            <span class="token string">"layers"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    id<span class="token punctuation">:</span><span class="token string">'background'</span><span class="token punctuation">,</span>
                    type<span class="token punctuation">:</span><span class="token string">'background'</span><span class="token punctuation">,</span>
                    paint<span class="token punctuation">:</span><span class="token punctuation">{</span>
                        <span class="token string">'background-color'</span><span class="token punctuation">:</span> <span class="token string">'rgba(16, 48, 98, 1)'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//限制可拖拽的区域</span>
        <span class="token keyword">var</span> bounds<span class="token operator">=</span><span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token number">118.795172005133</span><span class="token punctuation">,</span><span class="token number">32.488679624255155</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">121.43046465866001</span><span class="token punctuation">,</span><span class="token number">34.54595337207547</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          container<span class="token punctuation">:</span><span class="token string">'map'</span><span class="token punctuation">,</span>
          <span class="token comment" spellcheck="true">//style:'mapbox://styles/mapbox/streets-v9',</span>
          style<span class="token punctuation">:</span>mapStyle<span class="token punctuation">,</span>
          center<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">120.09549644174842</span><span class="token punctuation">,</span><span class="token number">33.35328924206773</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          zoom<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span>
          minZoom<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span>
          maxZoom<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">,</span>
          pitch<span class="token punctuation">:</span> <span class="token number">45</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的角度，不写默认是0，取值是0-60度，一般在3D中使用</span>
          bearing<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的初始方向，值是北的逆时针度数，默认是0，即是正北</span>
          antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//抗锯齿，通过false关闭提升性能</span>
          dragPan<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment" spellcheck="true">//maxBounds:bounds,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           window<span class="token punctuation">.</span>map<span class="token operator">=</span>that<span class="token punctuation">.</span>map<span class="token punctuation">;</span>

           <span class="token keyword">var</span> layers<span class="token operator">=</span> that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>layers<span class="token punctuation">;</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>layers<span class="token punctuation">)</span><span class="token punctuation">;</span> 

           that<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"东台"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.56307556429766</span><span class="token punctuation">,</span><span class="token number">32.789799061414485</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"大丰"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.56852984099595</span><span class="token punctuation">,</span><span class="token number">33.22370594310354</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"盐度"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.9035141347839</span><span class="token punctuation">,</span><span class="token number">33.220750931897314</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"市区"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.18468683439642</span><span class="token punctuation">,</span><span class="token number">33.403656091359125</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"建湖"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.78718476203835</span><span class="token punctuation">,</span><span class="token number">33.449976139591854</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"射阳"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.25880191403547</span><span class="token punctuation">,</span><span class="token number">33.78577955095302</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"滨海"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.0328499508251</span><span class="token punctuation">,</span><span class="token number">34.054170132435104</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"响水"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.69213130960708</span><span class="token punctuation">,</span><span class="token number">34.19873779241871</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
           that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"阜宁"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.64714823927494</span><span class="token punctuation">,</span><span class="token number">33.78699866627068</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

           <span class="token comment" spellcheck="true">//that.map.setPaintProperty('background', 'background-color', '#45516E');</span>
          <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'/static/320900.json'</span><span class="token punctuation">;</span> 

          that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">"markers"</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"geojson"</span><span class="token punctuation">,</span>
              <span class="token string">"data"</span><span class="token punctuation">:</span>url
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment" spellcheck="true">//普通贴地的多边形polygon</span>
<span class="token comment" spellcheck="true">/*
          that.map.addLayer({
            "id":"markers_polygon",
            "type":"fill",
            "visibility": "visible", 
            "source": "markers", 
            "paint":{
              "fill-color": "#195985", 
            }
          });
*/</span>           
          <span class="token comment" spellcheck="true">//polygon抬升</span>

          that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span><span class="token string">"markers_polygon_extrusion"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"fill-extrusion"</span><span class="token punctuation">,</span>
            <span class="token string">"visibility"</span><span class="token punctuation">:</span> <span class="token string">"visible"</span><span class="token punctuation">,</span> 
            <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"markers"</span><span class="token punctuation">,</span> 
            <span class="token string">"paint"</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
              <span class="token string">"fill-extrusion-color"</span><span class="token punctuation">:</span> <span class="token string">"#0A1B31"</span><span class="token punctuation">,</span> 
              <span class="token string">"fill-extrusion-base"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  
              <span class="token string">"fill-extrusion-height"</span><span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>  
              <span class="token string">'fill-extrusion-opacity'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
              <span class="token comment" spellcheck="true">//"fill-extrusion-translate":[0.3,1]  </span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



         <span class="token comment" spellcheck="true">//任意指定高度的3d线    </span>
              <span class="token comment" spellcheck="true">/*
          var lines=polygon2line(line_json_from);
          let lineBuffer = turf.buffer(lines, 0.0625 * resolutions[8], {
              units: 'meters'
          })

           that.map.addSource("lineBufferSource-6",{
              'type':'geojson',
              'data':lineBuffer
           });

            that.map.addLayer({
              'id':"lineBufferLayer-6",
              'type':'fill-extrusion',
              "visibility": "visible", 
              'source':"lineBufferSource-6",
              'minzoom':1,
              'maxzoom':18,
              'paint':{
                 // 'fill-extrusion-vertical-gradient': true,
                  'fill-extrusion-color': '#a0f0ff',
                  'fill-extrusion-height': 3100, // 挤出高度 3d线
                  'fill-extrusion-base': 3000,// 3d线底部的起始高度。必须小于或等于挤出高度
                  'fill-extrusion-opacity': 0.9,
              }
            });
            that.map.addLayer({
              'id':"lineBufferLayer-6",
              'type':'fill-extrusion',
              "visibility": "visible", 
              'source':"lineBufferSource-6",
              'minzoom':1,
              'maxzoom':18,
              'paint':{
                 // 'fill-extrusion-vertical-gradient': true,
                  'fill-extrusion-color': '#ffffff',
                  'fill-extrusion-height': 3100, // 挤出高度 3d线
                  'fill-extrusion-base': 3000,// 3d线底部的起始高度。必须小于或等于挤出高度
                  'fill-extrusion-opacity': 0.9,
              }
            });
            that.map.addLayer({
              'id':"lineBufferLayer-6",
              'type':'fill-extrusion',
              "visibility": "visible", 
              'source':"lineBufferSource-6",
              'minzoom':1,
              'maxzoom':18,
              'paint':{
                  'fill-extrusion-vertical-gradient': true,
                  'fill-extrusion-color': '#ffffff',
                  'fill-extrusion-height': 3100, // 挤出高度 3d线
                  'fill-extrusion-base': 3000,// 3d线底部的起始高度。必须小于或等于挤出高度
                  'fill-extrusion-opacity': 1,
              }
            });
         */</span>


        <span class="token comment" spellcheck="true">//发光线</span>
        <span class="token comment" spellcheck="true">//如果想发光更亮就可以用更多图层，更低的透明度，加上模糊程度，最关键的白线色图层要最后再加 </span>

        map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"route1"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
            <span class="token string">"source"</span><span class="token punctuation">:</span>  <span class="token string">"markers"</span><span class="token punctuation">,</span>
            <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#22b4ed"</span><span class="token punctuation">,</span>
                <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token string">"line-opacity"</span><span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
                <span class="token string">"line-blur"</span><span class="token punctuation">:</span><span class="token number">2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"route2"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
            <span class="token string">"source"</span><span class="token punctuation">:</span>  <span class="token string">"markers"</span><span class="token punctuation">,</span>
            <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#22b4ed"</span><span class="token punctuation">,</span>
                <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token string">"line-opacity"</span><span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
                <span class="token string">"line-blur"</span><span class="token punctuation">:</span><span class="token number">2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"routeBigWhite"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
            <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"markers"</span><span class="token punctuation">,</span>
            <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
                <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token comment" spellcheck="true">//"line-offset":[1,1]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>






          <span class="token comment" spellcheck="true">//贴在地图地面0高度的普通线</span>
          <span class="token comment" spellcheck="true">/*
        that.map.addLayer({
            "id":"markers",
            "type":"line",
            "visibility": "visible", 
            "source": "markers", 
            "paint":{
              "line-color":  'rgba(85, 85, 164, 1)', 
              "line-width": 5           
            }
          });

          */</span>



          <span class="token comment" spellcheck="true">//添加点Point(零高度)，可点击</span>

<span class="token comment" spellcheck="true">/*
          var geojsonPoints = {
              "type": "FeatureCollection",
              "features": [{
                  "type": "Feature",
                  "properties": {
                      "id":"任意标识1",
                      "name": "point1",
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [119.40812348603822,33.88810005467758]
                  }
              },{
                  "type": "Feature",
                  "properties": {
                      "id":"任意标识2",
                      "name": "point2",
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [119.32239507773556,33.34882369485305]
                  }
              }]
          };
          that.map.addSource('geodataPoint', { type: 'geojson', data: geojsonPoints });
          that.map.addLayer({
              'id': 'pointlayer',
              'type': 'circle',
              'source': "geodataPoint",
              'paint': {
                  'circle-radius':13,
                  "circle-color": "#B42222"
              }
          });

          that.map.addLayer({
              'id': 'pointlayerhighlight',
              'type': 'circle',
              'source': "geodataPoint",
              'paint': {
                  'circle-radius':13.2,
                  "circle-color": "#0000ff"
              },
              "filter": ["in", "id", "pointlayerhighlight"]
          });

          that.map.on('click', 'pointlayer', function(e) {
             //console.log(e);
              var feature = e.features[0];
               console.log(feature.properties.id);
              that.map.setFilter('pointlayerhighlight', ['in', 'id', feature.properties.id]);
              var popup = new Mapboxgl.Popup({
                  closeButton: false
              });
              popup.setLngLat(feature.geometry.coordinates)
                  .setText(feature.properties.id)
                  .addTo(that.map);
          });
*/</span> 



          <span class="token comment" spellcheck="true">//可抬升的点：用一个可变半径的polygon圆来替代点,抬升就靠polygon的抬升</span>
<span class="token comment" spellcheck="true">/*

          var dddyc=createCirclePolygonJsonFromPoint([120.37637097816969,33.22177134862909],1);
          that.map.addSource("PolygonPointdddyc",{
              "type":"geojson",
              "data":dddyc
          });
          that.map.addLayer({
            "id":"PolygonPointExtraYC",
            "type":"fill-extrusion",
            "visibility": "visible", 
            "source": "PolygonPointdddyc", 
            'paint':{
                  'fill-extrusion-vertical-gradient': true,
                  'fill-extrusion-color': '#00ff00',
                  'fill-extrusion-height': 3120,  
                  'fill-extrusion-base': 3000, 
            }
          });
          var ddd=createCirclePolygonJsonFromPoint([119.60635432454347,32.811373506617784],0.5);
          that.map.addSource("PolygonPoint",{
              "type":"geojson",
              "data":ddd
          });
          that.map.addLayer({
            "id":"PolygonPoint",
            "type":"fill",
            "visibility": "visible", 
            "source": "PolygonPoint", 
            "paint":{
              "fill-color": "#00ff00",  
            }
          }); 
          that.map.addLayer({
            "id":"PolygonPointHighLight",
            "type":"fill",
            "visibility": "visible", 
            "source": "PolygonPoint", 
            "paint":{
              "fill-color": "#ff0000",  
            },
            "filter": ["!=", "name", "zhangs"] //默认透明不可见
          });

          that.map.on('click', 'PolygonPoint', function(e) {
           console.log(e);
            //var feature = e.features[0];
            //   console.log(feature.properties.id);
            that.map.setFilter('PolygonPointHighLight', ['==', 'source',e.features[0].source]);

              var popup = new Mapboxgl.Popup({
                  closeButton: false
              });
              popup.setLngLat([e.lngLat.lng,e.lngLat.lat])
                  .setText(e.features[0].source)
                  .addTo(that.map);

          });
*/</span>


        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



         <span class="token comment" spellcheck="true">//工具函数</span>

        <span class="token comment" spellcheck="true">/**
         * Transforms Polygons and MultiPolygons to LineStrings.
         *
         * @module turf/polygonToLine
         * @category transformation
         * @param {Object} geojson any GeoJSON object
         * @returns {Object} FeatureCollection where
         * Polygons and MultiPolygons transformed to LineStrings.
         */</span>
        <span class="token keyword">function</span> <span class="token function">polygon2line</span><span class="token punctuation">(</span>geojson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> features <span class="token operator">=</span> geojson<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>toLineString<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> turf<span class="token punctuation">.</span><span class="token function">featureCollection</span><span class="token punctuation">(</span><span class="token function">flatten</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function">flatten</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>concat<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">polygonToLineString</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> coordinates<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> turf<span class="token punctuation">.</span><span class="token function">lineString</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">multiPolygonToLineString</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">flatten</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">polygonToLineString</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">toLineString</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> geometry <span class="token operator">=</span> feature<span class="token punctuation">.</span>geometry<span class="token punctuation">,</span>
                properties <span class="token operator">=</span> feature<span class="token punctuation">.</span>properties<span class="token punctuation">;</span>

            <span class="token keyword">switch</span> <span class="token punctuation">(</span>geometry<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token string">'Polygon'</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token function">polygonToLineString</span><span class="token punctuation">(</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token string">'MultiPolygon'</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token function">multiPolygonToLineString</span><span class="token punctuation">(</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> feature<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>




          <span class="token comment" spellcheck="true">//根据点(经纬度)获得圆polygon，半径为radiusInKm单位千米</span>

         <span class="token keyword">function</span> <span class="token function">createCirclePolygonJsonFromPoint</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> radiusInKm<span class="token punctuation">,</span> points<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>points<span class="token punctuation">)</span> points <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> coords <span class="token operator">=</span> <span class="token punctuation">{</span>
                latitude<span class="token punctuation">:</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                longitude<span class="token punctuation">:</span> center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> km <span class="token operator">=</span> radiusInKm<span class="token punctuation">;</span>
            <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> distanceX <span class="token operator">=</span> km<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">111.320</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span>latitude<span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> distanceY <span class="token operator">=</span> km<span class="token operator">/</span><span class="token number">110.574</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> theta<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>points<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                theta <span class="token operator">=</span> <span class="token punctuation">(</span>i<span class="token operator">/</span>points<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token punctuation">;</span>
                x <span class="token operator">=</span> distanceX<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
                y <span class="token operator">=</span> distanceY<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">;</span>

                ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>coords<span class="token punctuation">.</span>longitude<span class="token operator">+</span>x<span class="token punctuation">,</span> coords<span class="token punctuation">.</span>latitude<span class="token operator">+</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         
<span class="token comment" spellcheck="true">/*

{
              "type": "FeatureCollection",
              "features": [{
                  "type": "Feature",
                  "properties": {
                      "id":"任意标识1",
                      "name": "point1",
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [119.40812348603822,33.88810005467758]
                  }
              },{
                  "type": "Feature",
                  "properties": {
                      "id":"任意标识2",
                      "name": "point2",
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [119.32239507773556,33.34882369485305]
                  }
              }]
          };




{
   "type": "FeatureCollection",
   "features": [
      {
          "type": "Feature",
          "geometry": {
              "id":"zhangs",
              "type": "Polygon",
              "coordinates": [ret],

          }
      },

   ]

}


            return {

                "type": "Feature",
                "geometry": {
                    "id":"zhangs",
                    "type": "Polygon",
                    "coordinates": [ret],

                }
            };
*/</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
              <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                  <span class="token punctuation">{</span>
                      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
                      <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                          <span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"zhangs"</span><span class="token punctuation">,</span>
                          <span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"xyzmm"</span><span class="token punctuation">,</span>
                          <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Polygon"</span><span class="token punctuation">,</span>
                          <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>ret<span class="token punctuation">]</span><span class="token punctuation">,</span>

                      <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>

              <span class="token punctuation">]</span>

            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>




    <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token function">testone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>


   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

     <span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span> draggable<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     marker<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">114.32391708966355</span><span class="token punctuation">,</span><span class="token number">30.594908665167466</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     marker<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment" spellcheck="true">// marker.setOffset([0,-50]);</span>
     <span class="token comment" spellcheck="true">//marker.on("dragstart", onDragEnd);//鼠标移动结束 </span>
     <span class="token comment" spellcheck="true">//marker.on("drag", onDragEnd);//鼠标移动中 </span>
     marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"dragend"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动开始</span>

     <span class="token keyword">function</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> lngLat <span class="token operator">=</span> marker<span class="token punctuation">.</span><span class="token function">getLngLat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Longitude:"</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lng <span class="token operator">+</span> <span class="token string">"Latitude: "</span> <span class="token operator">+</span> lngLat<span class="token punctuation">.</span>lat <span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span>


   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token function">addMarkerCustom</span><span class="token punctuation">(</span>markName<span class="token punctuation">,</span>markValue<span class="token punctuation">,</span>lnglat<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token keyword">var</span> ele6060<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ele6060<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token template-string"><span class="token string">`
        &lt;div style="background:url('/static/locate.png');background-repeat: no-repeat;color:red;width:100px;height:120px;background-size:100%;"> &lt;div style="width:100px;height:8px;">&lt;/div> &lt;span style="color:white;font-size: 15px;margin-left:20px;">`</span></span><span class="token operator">+</span>markName<span class="token operator">+</span><span class="token template-string"><span class="token string">`&lt;/span>  `</span></span><span class="token operator">+</span>
        <span class="token template-string"><span class="token string">`&lt;span style="color:white;font-size: 25px;">`</span></span><span class="token operator">+</span>markValue<span class="token operator">+</span><span class="token template-string"><span class="token string">`&lt;/span> `</span></span><span class="token operator">+</span>
        <span class="token template-string"><span class="token string">`&lt;/div>
        `</span></span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>ele6060<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> marker6060 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            draggable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            element<span class="token punctuation">:</span> ele6060<span class="token punctuation">,</span>

            <span class="token comment" spellcheck="true">//color:'#000000'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        marker6060<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span>lnglat<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker6060<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">


<span class="token selector"><span class="token id">#map</span></span><span class="token punctuation">{</span> 
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.marker6060</span> </span><span class="token punctuation">{</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url('/static/1.png')</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">/*background: url('/static/1.png');*/</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">240</span>px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">240</span>px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Vue中安装ThreeJS"><a href="#Vue中安装ThreeJS" class="headerlink" title="Vue中安装ThreeJS"></a>Vue中安装ThreeJS</h2><ol>
<li>安装  </li>
</ol>
<p>vue2.0引入threejs会报错。直接在package.json文件dependencies节点里将three版本改成老版本(比如”^0.124”)，然后重新npm install即可。  </p>
<pre class="line-numbers language-html"><code class="language-html">npm install three --save  
package.json里修改three版本号  
重新npm install  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>vue引用threejs案例  </li>
</ol>
<pre class="line-numbers language-html"><code class="language-html">//HelloThree.vue

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hellothree<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">


<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Three <span class="token keyword">from</span> <span class="token string">'three'</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'HelloThree'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to HelloThree'</span><span class="token punctuation">,</span>
      camera<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      scene<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      renderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      mesh<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      webGLRenderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
    initThree<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span>clientWidth<span class="token operator">/</span>container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>MeshNormalMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webGLRenderer<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>clientWidth<span class="token punctuation">,</span> container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    animate<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">0.02</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    addEventListen<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span>getIntersects<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span>onWindowResize<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">getIntersects</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
            event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> raycaster<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> mouse<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>x<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX<span class="token operator">/</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>y<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientY<span class="token operator">/</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            raycaster<span class="token punctuation">.</span><span class="token function">setFromCamera</span><span class="token punctuation">(</span>mouse<span class="token punctuation">,</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> intersects<span class="token operator">=</span>raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//doSomethingSelectObj(intersects[0].object);</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"un click"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>            
        <span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function">onWindowResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            
            that<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>aspect <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 重新设置相机宽高比例            </span>
            that<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 更新相机投影矩阵            </span>
            that<span class="token punctuation">.</span>webGLRenderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 重新设置渲染器渲染范围</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initThree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
 <span class="token selector"><span class="token id">#container</span> </span><span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>


</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Mapboxgl通过custom图层添加threejs内容"><a href="#Mapboxgl通过custom图层添加threejs内容" class="headerlink" title="Mapboxgl通过custom图层添加threejs内容"></a>Mapboxgl通过custom图层添加threejs内容</h2><pre class="line-numbers language-html"><code class="language-html">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token keyword">import</span> Mapboxgl <span class="token keyword">from</span> <span class="token string">'mapbox-gl'</span>
<span class="token keyword">import</span> <span class="token string">'mapbox-gl/dist/mapbox-gl.css'</span>

<span class="token keyword">const</span> line_json_from<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./320900.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 


<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> THREE <span class="token keyword">from</span> <span class="token string">'three'</span>






<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'MapBoxglAndThree'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to MapBoxglAndThree'</span><span class="token punctuation">,</span>
      map<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>  
      camera<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      scene<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      renderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      mesh<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
      <span class="token function">initMapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>     
            Mapboxgl<span class="token punctuation">.</span>accessToken<span class="token operator">=</span><span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                container<span class="token punctuation">:</span><span class="token string">'map'</span><span class="token punctuation">,</span>
                style<span class="token punctuation">:</span><span class="token string">'mapbox://styles/mapbox/streets-v9'</span><span class="token punctuation">,</span>
                <span class="token comment" spellcheck="true">//center:[120.18449277217098,33.65304384188343],</span>
                center<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">118.78</span><span class="token punctuation">,</span> <span class="token number">32.04</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                zoom<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">,</span>
                pitch<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的角度，不写默认是0，取值是0-60度，一般在3D中使用</span>
                bearing<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的初始方向，值是北的逆时针度数，默认是0，即是正北</span>
                antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//抗锯齿，通过false关闭提升性能</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                window<span class="token punctuation">.</span>map <span class="token operator">=</span> that<span class="token punctuation">.</span>map<span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mapboxgl success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span><span class="token function">addLayer1Mapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment" spellcheck="true">//  console.log(window.map.displayedThree);</span>
                that<span class="token punctuation">.</span><span class="token function">initThreejs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">addLayer1Mapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">"markers"</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"geojson"</span><span class="token punctuation">,</span>
              <span class="token string">"data"</span><span class="token punctuation">:</span>line_json_from
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         
          <span class="token comment" spellcheck="true">//普通贴地的多边形polygon</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span><span class="token string">"markers_polygon"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"fill"</span><span class="token punctuation">,</span>
            <span class="token string">"visibility"</span><span class="token punctuation">:</span> <span class="token string">"visible"</span><span class="token punctuation">,</span> 
            <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"markers"</span><span class="token punctuation">,</span> 
            <span class="token string">"paint"</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
              <span class="token string">"fill-color"</span><span class="token punctuation">:</span> <span class="token string">"#0000ff"</span><span class="token punctuation">,</span>  
              <span class="token string">"fill-opacity"</span><span class="token punctuation">:</span><span class="token number">0.5</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'provinceHighlight'</span><span class="token punctuation">,</span>
            <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'fill-extrusion'</span><span class="token punctuation">,</span>
            <span class="token string">'source'</span><span class="token punctuation">:</span> <span class="token string">'markers'</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">//'source-layer': 'markers',</span>
            <span class="token string">'layout'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'visibility'</span><span class="token punctuation">:</span> <span class="token string">'visible'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'paint'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token string">'fill-extrusion-vertical-gradient'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token string">'fill-extrusion-color'</span><span class="token punctuation">:</span> <span class="token string">'#00ff00'</span><span class="token punctuation">,</span>
              <span class="token string">'fill-extrusion-height'</span><span class="token punctuation">:</span> <span class="token number">3500</span><span class="token punctuation">,</span>
              <span class="token comment" spellcheck="true">// 'fill-extrusion-height': {"stops": [[0, 100000], [18, 20000]]},</span>
              <span class="token string">'fill-extrusion-base'</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
              <span class="token string">'fill-extrusion-opacity'</span><span class="token punctuation">:</span> <span class="token number">0.8</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">//图层过滤显示:加载图层时，要控制显示和隐藏其中的某些元素，需要使用mapbox-gl的图层过滤接口。</span>
            <span class="token string">'filter'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


          <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token string">'markers_polygon'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
           <span class="token comment" spellcheck="true">// console.log(e.features[0]["properties"]["name"]);</span>
           <span class="token comment" spellcheck="true">// console.log(e.features[0]);</span>
           <span class="token comment" spellcheck="true">// 图层整体属性修改</span>
           <span class="token comment" spellcheck="true">// that.map.setPaintProperty('markers_polygon','fill-color','#ff0000');  </span>
           <span class="token comment" spellcheck="true">// 图层内部分属性修改(部分，图层内容过滤)</span>
           that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token string">'provinceHighlight'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"properties"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">initThreejs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> map1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">;</span>

        <span class="token keyword">var</span> modelOrigin <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">118.78</span><span class="token punctuation">,</span> <span class="token number">32.04</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true">// 添加模型的地理位置</span>
        <span class="token keyword">var</span> modelAltitude <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">var</span> modelRotate <span class="token operator">=</span> <span class="token punctuation">[</span>Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">var</span> modelScale <span class="token operator">=</span> <span class="token number">5.41843220338983e-8</span>
        <span class="token comment" spellcheck="true">// transformation parameters to position, rotate and scale the 3D model onto the map</span>
        <span class="token keyword">var</span> modelTransform <span class="token operator">=</span> <span class="token punctuation">{</span>
          translateX<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>
          translateY<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>
          translateZ<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span>
          rotateX<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          rotateY<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          rotateZ<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          scale<span class="token punctuation">:</span> modelScale
        <span class="token punctuation">}</span>


        <span class="token comment" spellcheck="true">// configuration of the custom layer for a 3D model per the CustomLayerInterface</span>
        <span class="token comment" spellcheck="true">// 自定义图层默认不接受鼠标响应,后面通过全局监听地图click事件，发射射线判断是否点击到三维物体</span>
        <span class="token keyword">var</span> customLayer <span class="token operator">=</span> <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token string">'3d-model'</span><span class="token punctuation">,</span>
          type<span class="token punctuation">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span>
          renderingMode<span class="token punctuation">:</span> <span class="token string">'3d'</span><span class="token punctuation">,</span>
          onAdd<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//this.camera = new THREE.Camera()</span>
            <span class="token comment" spellcheck="true">//this.camera = new THREE.OrthographicCamera()</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> canvas<span class="token punctuation">:</span> map<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> gl<span class="token punctuation">,</span> antialias<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">var</span> light <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointLight</span><span class="token punctuation">(</span><span class="token number">0xfca4c5</span><span class="token punctuation">)</span>
            light<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>light<span class="token punctuation">)</span>

            <span class="token comment" spellcheck="true">// 自定义图片的正方体模型</span>
            <span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./10.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 模型自定义图片</span>
            <span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxBufferGeometry</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 模型大小</span>
            <span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> map<span class="token punctuation">:</span> texture <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
            mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 模型在xyz轴位置</span>
            mesh<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">"myfirstBox"</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span>

            <span class="token comment" spellcheck="true">//  模型也可以换成自定义颜色，写法同自定义图片的方式差不多</span>
            <span class="token comment" spellcheck="true">// var material = new THREE.MeshBasicMaterial({ color: '#256484' }) </span>
            <span class="token comment" spellcheck="true">// var geometry = new THREE.BoxBufferGeometry(10, 10, 10) // 模型大小</span>
            <span class="token comment" spellcheck="true">// var mesh = new THREE.Mesh(geometry, material)</span>
            <span class="token comment" spellcheck="true">// mesh.position.set(0, 10, 10) // 模型在xyz轴位置</span>
            <span class="token comment" spellcheck="true">// this.scene.add(mesh)</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>autoClear <span class="token operator">=</span> <span class="token boolean">false</span>

            that<span class="token punctuation">.</span>camera<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">;</span>
            that<span class="token punctuation">.</span>scene<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">;</span>
            that<span class="token punctuation">.</span>renderer<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">;</span>

          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          render<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> matrix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> rotationX <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateX
            <span class="token punctuation">)</span>
            <span class="token keyword">var</span> rotationY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateY
            <span class="token punctuation">)</span>
            <span class="token keyword">var</span> rotationZ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateZ
            <span class="token punctuation">)</span>

            <span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromArray</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span>
            <span class="token keyword">var</span> l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">makeTranslation</span><span class="token punctuation">(</span>
                modelTransform<span class="token punctuation">.</span>translateX<span class="token punctuation">,</span>
                modelTransform<span class="token punctuation">.</span>translateY<span class="token punctuation">,</span>
                modelTransform<span class="token punctuation">.</span>translateZ
              <span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>
                  modelTransform<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
                  <span class="token operator">-</span>modelTransform<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
                  modelTransform<span class="token punctuation">.</span>scale
                <span class="token punctuation">)</span>
              <span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationX<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationY<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationZ<span class="token punctuation">)</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>projectionMatrix <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">resetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span>




            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"dsfasdafdsf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


       <span class="token comment" spellcheck="true">// map1.addLayer(customLayer, 'waterway-label');</span>
        map1<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>customLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//查询所有图层</span>
        <span class="token comment" spellcheck="true">//var layers= map1.getStyle().layers;</span>
        <span class="token comment" spellcheck="true">//console.log(layers);</span>



        <span class="token comment" spellcheck="true">//map1.on('style.load', function() {</span>
        <span class="token comment" spellcheck="true">//  map1.addLayer(customLayer, 'waterway-label');           </span>
        <span class="token comment" spellcheck="true">//}) </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      addEventListen<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>

         <span class="token comment" spellcheck="true">//通过发射射线触发三维模型</span>
        that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
             event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> raycaster<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> mouse<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>x<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>point<span class="token punctuation">.</span>x<span class="token operator">/</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>y<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>point<span class="token punctuation">.</span>y<span class="token operator">/</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mouse<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

            raycaster<span class="token punctuation">.</span><span class="token function">setFromCamera</span><span class="token punctuation">(</span>mouse<span class="token punctuation">,</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> intersects<span class="token operator">=</span>raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//doSomethingSelectObj(intersects[0].object);</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"un clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>            
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
<span class="token selector"><span class="token id">#map</span></span><span class="token punctuation">{</span> 
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>



<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ThreeJS绘制geojson地图"><a href="#ThreeJS绘制geojson地图" class="headerlink" title="ThreeJS绘制geojson地图"></a>ThreeJS绘制geojson地图</h2><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Three_geojson<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token comment" spellcheck="true">/*
npm install three --save  
package.json里修改threejs版本^0.124
npm install d3 --save  
npm install d3-geo --save  

我安装了npm install three-orbitcontrols-ts --save，但是并没有使用这个，用的是原生控制器
*/</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Three <span class="token keyword">from</span> <span class="token string">'three'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> d3 <span class="token keyword">from</span> <span class="token string">'d3'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>OrbitControls<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/controls/OrbitControls.js"</span><span class="token punctuation">;</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'Three_geojson'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to Three_geojson'</span><span class="token punctuation">,</span>
      camera<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      scene<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      renderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      mesh<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      webGLRenderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      geomap<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      controls<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
    initThree<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span>clientWidth<span class="token operator">/</span>container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">22.183612482147442</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7.959582984652089</span><span class="token punctuation">,</span> <span class="token number">7.2065684392905585</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>MeshNormalMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webGLRenderer<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>clientWidth<span class="token punctuation">,</span> container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrbitControls</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 动态阻尼系数 就是鼠标拖拽旋转灵敏度，阻尼越小越灵敏</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>dampingFactor <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 是否可以缩放</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>enableZoom <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//是否自动旋转</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>autoRotate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//设置相机距离原点的最近距离</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>minDistance <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//设置相机距离原点的最远距离</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>maxDistance <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//是否开启右键拖拽</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>enablePan <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//上下翻转的最大角度</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>maxPolarAngle <span class="token operator">=</span> <span class="token number">88.5</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//上下翻转的最小角度</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>controls<span class="token punctuation">.</span>minPolarAngle <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 是否可以旋转</span>
        <span class="token comment" spellcheck="true">// this.enableRotate = true</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    animate<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">0.02</span><span class="token punctuation">;</span>        
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    addEventListen<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span>getIntersects<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span>onWindowResize<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">getIntersects</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
            event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> raycaster<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> mouse<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>x<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX<span class="token operator">/</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>y<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientY<span class="token operator">/</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            raycaster<span class="token punctuation">.</span><span class="token function">setFromCamera</span><span class="token punctuation">(</span>mouse<span class="token punctuation">,</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> intersects<span class="token operator">=</span>raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//doSomethingSelectObj(intersects[0].object);</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"un click"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>            
        <span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function">onWindowResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            
            that<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>aspect <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 重新设置相机宽高比例            </span>
            that<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 更新相机投影矩阵            </span>
            that<span class="token punctuation">.</span>webGLRenderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 重新设置渲染器渲染范围</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    LoadGeoJson<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> _this<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>FileLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//loader.load('/static/china.json',function(data){</span>
        loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'/static/320900.json'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//console.log(data);</span>
            <span class="token keyword">let</span> jsonData<span class="token operator">=</span>JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _this<span class="token punctuation">.</span><span class="token function">InitGeoMap</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    InitGeoMap<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>chinaJson<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> _this<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>        

        <span class="token keyword">this</span><span class="token punctuation">.</span>geomap<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 墨卡托投影转换</span>
        <span class="token keyword">const</span> projection <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">geoMercator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">center</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">104.0</span><span class="token punctuation">,</span> <span class="token number">37.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        chinaJson<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>elem <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 定一个省份3D对象</span>
            <span class="token keyword">const</span> province <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 每个的 坐标 数组</span>
            <span class="token keyword">const</span> coordinates <span class="token operator">=</span> elem<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 循环坐标数组</span>
            coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>multiPolygon <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>

                multiPolygon<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>polygon <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> shape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">const</span> lineMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'white'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">const</span> lineGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Geometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> polygon<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span>polygon<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            shape<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        shape<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        lineGeometry<span class="token punctuation">.</span>vertices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">,</span> <span class="token number">4.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">const</span> extrudeSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
                        depth<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                        bevelEnabled<span class="token punctuation">:</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>

                    <span class="token keyword">const</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>ExtrudeGeometry</span><span class="token punctuation">(</span>shape<span class="token punctuation">,</span> extrudeSettings<span class="token punctuation">)</span>
                    <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'#02A1E2'</span><span class="token punctuation">,</span> transparent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> opacity<span class="token punctuation">:</span> <span class="token number">0.6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> material1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'#3480C4'</span><span class="token punctuation">,</span> transparent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> opacity<span class="token punctuation">:</span> <span class="token number">0.5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> <span class="token punctuation">[</span>material<span class="token punctuation">,</span> material1<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Three<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>lineGeometry<span class="token punctuation">,</span> lineMaterial<span class="token punctuation">)</span>

                    province<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span>
                    province<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

                <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment" spellcheck="true">// 将geo的属性放到省份模型中</span>
            province<span class="token punctuation">.</span>properties <span class="token operator">=</span> elem<span class="token punctuation">.</span>properties<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>contorid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>contorid<span class="token punctuation">)</span><span class="token punctuation">;</span>
            province<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>_centroid <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            _this<span class="token punctuation">.</span>geomap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>province<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>geomap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>geomap<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">22.183612482147442</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">7.959582984652089</span><span class="token punctuation">,</span> <span class="token number">7.2065684392905585</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>geomap<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      window<span class="token punctuation">.</span>Vue<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initThree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">LoadGeoJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
 <span class="token selector"><span class="token id">#container</span> </span><span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Three绘制geojson与Mapboxgl在Vue里结合案例"><a href="#Three绘制geojson与Mapboxgl在Vue里结合案例" class="headerlink" title="Three绘制geojson与Mapboxgl在Vue里结合案例"></a>Three绘制geojson与Mapboxgl在Vue里结合案例</h2><p><a href="https://pan.baidu.com/s/1dHNdU1S4PpC-OHhxiJaArA" target="_blank" rel="noopener">Three绘制geojson与Mapboxgl在Vue里结合案例 </a>  </p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">
<span class="token keyword">import</span> Mapboxgl <span class="token keyword">from</span> <span class="token string">'mapbox-gl'</span>
<span class="token keyword">import</span> <span class="token string">'mapbox-gl/dist/mapbox-gl.css'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> THREE <span class="token keyword">from</span> <span class="token string">'three'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> d3 <span class="token keyword">from</span> <span class="token string">'d3'</span>

<span class="token keyword">const</span> line_json_from<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./320900.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'MapBoxglAndThree'</span><span class="token punctuation">,</span>
  data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Welcome to MapBoxglAndThree'</span><span class="token punctuation">,</span>
      map<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>  
      camera<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      scene<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      renderer<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      mesh<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
      geomap<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
      <span class="token function">initMapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>              
            <span class="token keyword">var</span> mapStyle <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"BlankBackground"</span><span class="token punctuation">,</span>
                <span class="token string">"sources"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"mapbox"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"vector"</span><span class="token punctuation">,</span>
                        <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"mapbox://mapbox.mapbox-streets-v8"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"sprite"</span><span class="token punctuation">:</span> <span class="token string">"mapbox://sprites/mapbox/dark-v10"</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">//  "glyphs": "mapbox://fonts/mapbox/{fontstack}/{range}.pbf",</span>
                <span class="token string">"layers"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        id<span class="token punctuation">:</span><span class="token string">'background'</span><span class="token punctuation">,</span>
                        type<span class="token punctuation">:</span><span class="token string">'background'</span><span class="token punctuation">,</span>
                        paint<span class="token punctuation">:</span><span class="token punctuation">{</span>
                            <span class="token string">'background-color'</span><span class="token punctuation">:</span> <span class="token string">'rgba(16, 48, 98, 1)'</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            Mapboxgl<span class="token punctuation">.</span>accessToken<span class="token operator">=</span><span class="token string">'pk.eyJ1IjoiZml6ejExIiwiYSI6ImNrc244am0xczB5N2kycW1tMTQxenptcmMifQ.jCWWOQsBLvRssVVwTgUZsA'</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                container<span class="token punctuation">:</span><span class="token string">'map'</span><span class="token punctuation">,</span>
                style<span class="token punctuation">:</span>mapStyle<span class="token punctuation">,</span>
                <span class="token comment" spellcheck="true">//style:'mapbox://styles/mapbox/streets-v9',</span>
                center<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">120.09549644174842</span><span class="token punctuation">,</span><span class="token number">33.35328924206773</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                zoom<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">// </span>
                maxZoom<span class="token punctuation">:</span><span class="token number">8.5</span><span class="token punctuation">,</span>
                pitch<span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的角度，不写默认是0，取值是0-60度，一般在3D中使用</span>
                maxPitch<span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
                bearing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//地图的初始方向，值是北的逆时针度数，默认是0，即是正北</span>
                antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//抗锯齿，通过false关闭提升性能</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                window<span class="token punctuation">.</span>map <span class="token operator">=</span> that<span class="token punctuation">.</span>map<span class="token punctuation">;</span>                 
                <span class="token comment" spellcheck="true">//that.addLayer1Mapboxgl();</span>
                <span class="token comment" spellcheck="true">//that.initThreejs();</span>
                that<span class="token punctuation">.</span><span class="token function">LoadThreeGeoJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//that.addMarker();                </span>
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"东台"</span><span class="token punctuation">,</span><span class="token string">"91"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.56307556429766</span><span class="token punctuation">,</span><span class="token number">32.789799061414485</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"大丰"</span><span class="token punctuation">,</span><span class="token string">"92"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.56852984099595</span><span class="token punctuation">,</span><span class="token number">33.22370594310354</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"盐度"</span><span class="token punctuation">,</span><span class="token string">"93"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.9035141347839</span><span class="token punctuation">,</span><span class="token number">33.220750931897314</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"市区"</span><span class="token punctuation">,</span><span class="token string">"94"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.18468683439642</span><span class="token punctuation">,</span><span class="token number">33.403656091359125</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"建湖"</span><span class="token punctuation">,</span><span class="token string">"95"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.78718476203835</span><span class="token punctuation">,</span><span class="token number">33.449976139591854</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"射阳"</span><span class="token punctuation">,</span><span class="token string">"96"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.25880191403547</span><span class="token punctuation">,</span><span class="token number">33.78577955095302</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"滨海"</span><span class="token punctuation">,</span><span class="token string">"97"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">120.0328499508251</span><span class="token punctuation">,</span><span class="token number">34.054170132435104</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"响水"</span><span class="token punctuation">,</span><span class="token string">"98"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.69213130960708</span><span class="token punctuation">,</span><span class="token number">34.19873779241871</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                that<span class="token punctuation">.</span><span class="token function">addMarkerCustom</span><span class="token punctuation">(</span><span class="token string">"阜宁"</span><span class="token punctuation">,</span><span class="token string">"99"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">119.64714823927494</span><span class="token punctuation">,</span><span class="token number">33.78699866627068</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'render'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getZoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment" spellcheck="true">//if(e.target.getZoom()>14){</span>
              <span class="token comment" spellcheck="true">//  e.target.setZoom(14);</span>
              <span class="token comment" spellcheck="true">//}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">AddLayerThreeYC</span><span class="token punctuation">(</span>chinaJson<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> _this<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> map1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">;</span>
        <span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> modelOrigin <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">120.09549644174842</span><span class="token punctuation">,</span><span class="token number">33.35328924206773</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true">// 添加模型的地理位置</span>
        <span class="token keyword">var</span> modelAltitude <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">var</span> modelRotate <span class="token operator">=</span> <span class="token punctuation">[</span>Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">var</span> modelScale <span class="token operator">=</span> <span class="token number">5.41843220338983e-8</span>
        <span class="token comment" spellcheck="true">// transformation parameters to position, rotate and scale the 3D model onto the map</span>
        <span class="token keyword">var</span> modelTransform <span class="token operator">=</span> <span class="token punctuation">{</span>
          translateX<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>
          translateY<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>
          translateZ<span class="token punctuation">:</span> Mapboxgl<span class="token punctuation">.</span>MercatorCoordinate<span class="token punctuation">.</span><span class="token function">fromLngLat</span><span class="token punctuation">(</span>modelOrigin <span class="token punctuation">,</span> modelAltitude<span class="token punctuation">)</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span>
          rotateX<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          rotateY<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          rotateZ<span class="token punctuation">:</span> modelRotate<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          scale<span class="token punctuation">:</span> modelScale
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> customLayer <span class="token operator">=</span> <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token string">'3d-model-YC'</span><span class="token punctuation">,</span>
          type<span class="token punctuation">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span>
          renderingMode<span class="token punctuation">:</span> <span class="token string">'3d'</span><span class="token punctuation">,</span>
          onAdd<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>             
            <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span>clientWidth<span class="token operator">/</span>container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">80000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>far<span class="token operator">=</span><span class="token number">50000</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> canvas<span class="token punctuation">:</span> map<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> gl<span class="token punctuation">,</span> antialias<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
            <span class="token comment" spellcheck="true">//添加yc模型  </span>
            <span class="token keyword">var</span> geomap<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      
            <span class="token comment" spellcheck="true">// 墨卡托投影转换      </span>
            <span class="token keyword">const</span> projection <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">geoMercator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">center</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">120.09549644174842</span><span class="token punctuation">,</span><span class="token number">33.35328924206773</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            chinaJson<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>elem <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
                  <span class="token keyword">const</span> province <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">const</span> coordinates <span class="token operator">=</span> elem<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">;</span>
                  coordinates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>multiPolygon <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    
                      multiPolygon<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>polygon <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
                          <span class="token keyword">const</span> shape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token keyword">const</span> lineMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>color<span class="token punctuation">:</span> <span class="token string">'#7efbff'</span><span class="token punctuation">,</span>linewidth<span class="token punctuation">:</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token keyword">const</span> lineGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Geometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token keyword">const</span> extrudeHight<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">;</span>
                          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> polygon<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                              <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span>polygon<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                  shape<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token punctuation">}</span>
                              shape<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                              lineGeometry<span class="token punctuation">.</span>vertices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>y<span class="token punctuation">,</span> extrudeHight<span class="token operator">+</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token punctuation">}</span>        
                          <span class="token keyword">const</span> extrudeSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
                              depth<span class="token punctuation">:</span> extrudeHight<span class="token punctuation">,</span>
                              bevelEnabled<span class="token punctuation">:</span> <span class="token boolean">false</span>
                          <span class="token punctuation">}</span><span class="token punctuation">;</span>        
                          <span class="token keyword">const</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ExtrudeGeometry</span><span class="token punctuation">(</span>shape<span class="token punctuation">,</span> extrudeSettings<span class="token punctuation">)</span>
                          <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'#1b5a83'</span><span class="token punctuation">,</span> transparent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> opacity<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                          <span class="token keyword">const</span> material1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'#082a42'</span><span class="token punctuation">,</span> transparent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> opacity<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                          <span class="token keyword">const</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> <span class="token punctuation">[</span>material<span class="token punctuation">,</span> material1<span class="token punctuation">]</span><span class="token punctuation">)</span>
                          <span class="token keyword">const</span> line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>lineGeometry<span class="token punctuation">,</span> lineMaterial<span class="token punctuation">)</span>
                          province<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span>                   
                          province<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>                     
                          mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">37000</span><span class="token punctuation">,</span><span class="token number">37000</span><span class="token punctuation">,</span><span class="token number">37000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          line<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">37000</span><span class="token punctuation">,</span><span class="token number">37000</span><span class="token punctuation">,</span><span class="token number">37000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span>Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
                          line<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span>Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
                          mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          line<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8050</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                      <span class="token punctuation">}</span><span class="token punctuation">)</span>    
                  <span class="token punctuation">}</span><span class="token punctuation">)</span>


                  province<span class="token punctuation">.</span>properties <span class="token operator">=</span> elem<span class="token punctuation">.</span>properties<span class="token punctuation">;</span>
                  <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>contorid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>contorid<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    province<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>_centroid <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
                  <span class="token punctuation">}</span>           
                  geomap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>province<span class="token punctuation">)</span><span class="token punctuation">;</span>    
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token comment" spellcheck="true">//添加顶面蒙板层</span>
              <span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./menban.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 模型自定义图片</span>
              <span class="token keyword">let</span> geometryMenBan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PlaneGeometry</span><span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">,</span><span class="token number">60000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">let</span> materialMenBan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>map<span class="token punctuation">:</span> texture<span class="token punctuation">,</span> transparent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> opacity<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">let</span> MenBan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometryMenBan<span class="token punctuation">,</span>materialMenBan<span class="token punctuation">)</span><span class="token punctuation">;</span>
              MenBan<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">2.2</span><span class="token punctuation">,</span><span class="token number">2.2</span><span class="token punctuation">,</span><span class="token number">2.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              MenBan<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">1100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              MenBan<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// -Math.PI / 2;</span>
              MenBan<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// -Math.PI / 2;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>MenBan<span class="token punctuation">)</span><span class="token punctuation">;</span>

              <span class="token keyword">this</span><span class="token punctuation">.</span>mesh<span class="token operator">=</span>geomap<span class="token punctuation">;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>geomap<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 



              <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>autoClear <span class="token operator">=</span> <span class="token boolean">false</span>

              that<span class="token punctuation">.</span>camera<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">;</span>
              that<span class="token punctuation">.</span>scene<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">;</span>
              that<span class="token punctuation">.</span>renderer<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">;</span>

          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          render<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> matrix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> rotationX <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateX
            <span class="token punctuation">)</span>
            <span class="token keyword">var</span> rotationY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateY
            <span class="token punctuation">)</span>
            <span class="token keyword">var</span> rotationZ <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRotationAxis</span><span class="token punctuation">(</span>
              <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              modelTransform<span class="token punctuation">.</span>rotateZ
            <span class="token punctuation">)</span>
            <span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromArray</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span>
            <span class="token keyword">var</span> l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">makeTranslation</span><span class="token punctuation">(</span>
                modelTransform<span class="token punctuation">.</span>translateX<span class="token punctuation">,</span>
                modelTransform<span class="token punctuation">.</span>translateY<span class="token punctuation">,</span>
                modelTransform<span class="token punctuation">.</span>translateZ
              <span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>
                  modelTransform<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
                  <span class="token operator">-</span>modelTransform<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
                  modelTransform<span class="token punctuation">.</span>scale
                <span class="token punctuation">)</span>
              <span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationX<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationY<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>rotationZ<span class="token punctuation">)</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>projectionMatrix <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">resetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        map1<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>customLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">addLayer1Mapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
          <span class="token comment" spellcheck="true">//0高度polygon</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">"markers"</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"geojson"</span><span class="token punctuation">,</span>
              <span class="token string">"data"</span><span class="token punctuation">:</span>line_json_from
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         
          that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span><span class="token string">"markers_polygon"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"fill"</span><span class="token punctuation">,</span>
            <span class="token string">"visibility"</span><span class="token punctuation">:</span> <span class="token string">"visible"</span><span class="token punctuation">,</span> 
            <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"markers"</span><span class="token punctuation">,</span> 
            <span class="token string">"paint"</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
              <span class="token string">"fill-color"</span><span class="token punctuation">:</span> <span class="token string">"#195985"</span><span class="token punctuation">,</span> 
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment" spellcheck="true">//0高度线条</span>
          map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"route1"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
            <span class="token string">"source"</span><span class="token punctuation">:</span>  <span class="token string">"markers"</span><span class="token punctuation">,</span>
            <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#22b4ed"</span><span class="token punctuation">,</span>
                <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token string">"line-opacity"</span><span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
                <span class="token string">"line-blur"</span><span class="token punctuation">:</span><span class="token number">2</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"route2"</span><span class="token punctuation">,</span>
              <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
              <span class="token string">"source"</span><span class="token punctuation">:</span>  <span class="token string">"markers"</span><span class="token punctuation">,</span>
              <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                  <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                  <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                  <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#22b4ed"</span><span class="token punctuation">,</span>
                  <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
                  <span class="token string">"line-opacity"</span><span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
                  <span class="token string">"line-blur"</span><span class="token punctuation">:</span><span class="token number">2</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"routeBigWhite"</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"line"</span><span class="token punctuation">,</span>
            <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"markers"</span><span class="token punctuation">,</span>
            <span class="token string">"layout"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-join"</span><span class="token punctuation">:</span> <span class="token string">"round"</span><span class="token punctuation">,</span>
                <span class="token string">"line-cap"</span><span class="token punctuation">:</span> <span class="token string">"round"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"paint"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"line-color"</span><span class="token punctuation">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
                <span class="token string">"line-width"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token punctuation">}</span><span class="token punctuation">,</span>      
      addEventListen<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>

         <span class="token comment" spellcheck="true">//通过发射射线触发三维模型</span>
        that<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
             event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> raycaster<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> mouse<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>x<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>point<span class="token punctuation">.</span>x<span class="token operator">/</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            mouse<span class="token punctuation">.</span>y<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>point<span class="token punctuation">.</span>y<span class="token operator">/</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mouse<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

            raycaster<span class="token punctuation">.</span><span class="token function">setFromCamera</span><span class="token punctuation">(</span>mouse<span class="token punctuation">,</span>that<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> intersects<span class="token operator">=</span>raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//doSomethingSelectObj(intersects[0].object);</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"un clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>            
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">addMarkerCustom</span><span class="token punctuation">(</span>markName<span class="token punctuation">,</span>markValue<span class="token punctuation">,</span>lnglat<span class="token punctuation">)</span><span class="token punctuation">{</span>            
            <span class="token keyword">var</span> ele6060<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ele6060<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token template-string"><span class="token string">`
            &lt;div style="background:url('/static/locate.png');background-repeat: no-repeat;color:red;width:100px;height:120px;background-size:100%;"> &lt;div style="width:100px;height:8px;">&lt;/div> &lt;span style="color:white;font-size: 15px;margin-left:20px;">`</span></span><span class="token operator">+</span>markName<span class="token operator">+</span><span class="token template-string"><span class="token string">`&lt;/span>  `</span></span><span class="token operator">+</span>
            <span class="token template-string"><span class="token string">`&lt;span style="color:white;font-size: 25px;">`</span></span><span class="token operator">+</span>markValue<span class="token operator">+</span><span class="token template-string"><span class="token string">`&lt;/span> `</span></span><span class="token operator">+</span>
            <span class="token template-string"><span class="token string">`&lt;/div>
            `</span></span><span class="token punctuation">;</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>ele6060<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> marker6060 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                draggable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                element<span class="token punctuation">:</span> ele6060<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            marker6060<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span>lnglat<span class="token punctuation">)</span><span class="token punctuation">;</span> 
            marker6060<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">addMarker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       
        <span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span><span class="token punctuation">{</span> draggable<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker<span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">121.48205162185536</span><span class="token punctuation">,</span><span class="token number">33.72524335803726</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        marker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"dragend"</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//鼠标移动开始</span>
        <span class="token keyword">function</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> lngLat <span class="token operator">=</span> marker<span class="token punctuation">.</span><span class="token function">getLngLat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
            <span class="token comment" spellcheck="true">//console.log("Longitude:" + lngLat.lng + "Latitude: " + lngLat.lat ); </span>
        <span class="token punctuation">}</span>         

      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">LoadThreeGeoJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">let</span> _this<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>FileLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'/static/320900.json'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">let</span> jsonData<span class="token operator">=</span>JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
              _this<span class="token punctuation">.</span><span class="token function">AddLayerThreeYC</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>


  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMapboxgl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- Add "scoped" attribute to limit CSS to this component only --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style language-css">
<span class="token selector"><span class="token id">#map</span></span><span class="token punctuation">{</span> 
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> 
    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Vue里的threejs引入视角控制OrbitControls"><a href="#Vue里的threejs引入视角控制OrbitControls" class="headerlink" title="Vue里的threejs引入视角控制OrbitControls"></a>Vue里的threejs引入视角控制OrbitControls</h2><pre class="line-numbers language-html"><code class="language-html">import {OrbitControls} from "three/examples/jsm/controls/OrbitControls.js";  

this.controls = new OrbitControls(this.camera,this.renderer.domElement);  

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="threejs的渐变透明贴图"><a href="#threejs的渐变透明贴图" class="headerlink" title="threejs的渐变透明贴图"></a>threejs的渐变透明贴图</h2><pre class="line-numbers language-html"><code class="language-html">var texture = new Three.TextureLoader().load(require('./alphatest1.png'))  
var material = new Three.MeshBasicMaterial({ map: texture, transparent: true, opacity: 0.9});           
let geometry = new Three.BoxGeometry(0.2, 0.2, 0.2);
this.mesh = new Three.Mesh(geometry, material);
this.scene.add(this.mesh);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="MapboxGl自定义一个浮云组件，使用marker"><a href="#MapboxGl自定义一个浮云组件，使用marker" class="headerlink" title="MapboxGl自定义一个浮云组件，使用marker"></a>MapboxGl自定义一个浮云组件，使用marker</h2><pre class="line-numbers language-html"><code class="language-html">//浮云
var el = document.getElementById("baseMapPopup");
var baseMapPopup = new mapboxgl.Marker(el).setLngLat([0, 0]).addTo(map).setOffset([0,-10]);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="MapboxGL使用小结"><a href="#MapboxGL使用小结" class="headerlink" title="MapboxGL使用小结"></a>MapboxGL使用小结</h2><pre class="line-numbers language-html"><code class="language-html">相关链接  
https://docs.mapbox.com/mapbox-gl-js/api/  

https://github.com/mapbox/mapbox-gl-js  

https://mp.weixin.qq.com/s/44zNqiFjJ4quc0AKG0_Vqw  

https://www.jianshu.com/p/693f38ec5730  

//注册鼠标悬浮
map.on("mousemove", "symbol3", function(e) {
    map.getCanvas().style.cursor = "pointer";
});
map.on("mouseleave", "symbol3", function() {
    map.getCanvas().style.cursor = "";
});

//注册监听
map.on("click", "symbol3", function(e) {
    map.getCanvas().style.cursor = "pointer";
    var p = e.features[0].properties;
    var id = p.id;                           
    map.setFilter("selSymbol3", ["==", "id", id]); 
});

//筛选数据  
 map.setFilter('symbol', ['==', 'name', 'dangerous']);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="计算经纬度距离"><a href="#计算经纬度距离" class="headerlink" title="计算经纬度距离"></a>计算经纬度距离</h3><pre class="line-numbers language-html"><code class="language-html">//计算距离，参数分别为第一点的纬度，经度；第二点的纬度，经度
 function getDistance(lat1,lng1,lat2,lng2){
     var radLat1 = Rad(lat1);
     var radLat2 = Rad(lat2);
     var a = radLat1 - radLat2;
     var b = Rad(lng1) - Rad(lng2);
     var s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2) +
     Math.cos(radLat1)*Math.cos(radLat2)*Math.pow(Math.sin(b/2),2)));
     s = s *6378.137 ;// EARTH_RADIUS;
     s = Math.round(s * 10000) / 10; //输出为公里
     let result={
         dis:s,
         consa:a,
         sina:b
     }
     return result;
 function Rad(d){
    return d * Math.PI / 180.0;//经纬度转换成三角函数中度分表形式。
 }
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="添加图层（填充、纹理、描边）"><a href="#添加图层（填充、纹理、描边）" class="headerlink" title="添加图层（填充、纹理、描边）"></a>添加图层（填充、纹理、描边）</h3><pre class="line-numbers language-html"><code class="language-html">var citySource = {
        "type": "geojson",
        "data": cityJson
    }; 
        //填充
        map.addLayer({
            'id': 'cityFill',
            'type': 'fill',
            'source': citySource,
            'layout': {},
            'paint': {
                'fill-color': '#003997',
                'fill-opacity': 0.4
            }
        });
        //纹理
        map.addLayer({
            'id': 'cityRegion',
            'type': 'fill',
            'source': citySource,
            'layout': {},
            'paint': {
                'fill-outline-color': 'rgba(0,0,0,0)',
                'fill-pattern': 'darkBlue' //纹理，地图初始化时必须已加载该图片
            }
        }, 'cityFill');
    }
    //描边
    map.addLayer({
        'id': 'cityBorder',
        'type': 'line',
        'source': citySource,
        'layout': {},
        'paint': {
            'line-color': '#00c4ff',
            "line-width": {
                "base": 1.5,
                "stops": [
                    [5, 1],
                    [7, 2],
                    [11, 3]
                ]
            },
            "line-opacity": 1
        }
    });
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="离线化Mapbox地图实践方法"><a href="#离线化Mapbox地图实践方法" class="headerlink" title="离线化Mapbox地图实践方法"></a>离线化Mapbox地图实践方法</h3><pre class="line-numbers language-html"><code class="language-html">var webUrl = config.PROXY+'?url='+ config.WEBURL//'http://localhost:8080/ProxyServlet/proxyHandler?url=http://localhost:8080/';
            var mapboxTileUrl = webUrl + "mapboxLayer/{z}/{x}/{y}.pbf";  //mapbox瓦片地址
            var buildingUrl = webUrl+'QHbuilding/building2.json';//房屋面数据地址
            var linesUrl = webUrl+'QHbuilding/lines.json';//分区线数据地址
           //可在mapbox制图中生成
            var MAPSTYLE={
                "version": 8,
                "name": "Dark",
                "center": [113.890921, 22.497136],
                "zoom": 13,
                "pitch": 60,
                "sources": {
                    "composite": {//瓦片
                        "type": "vector",
                        "scheme": "xyz",
                        "tiles": [mapboxTileUrl]
                    },
                    "building":{
                        "type":'geojson',
                        "data":buildingUrl
                    },
                    'lines':{
                      'type':'geojson',
                      'data':linesUrl
                    }
                },
                "layers": [
                    {
                        "id": "land",
                        "type": "background",
                        "layout": {},
                        "paint": {"background-color": "#011d42"}
                    },
                    {
                        "id": "landcover",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "landcover",
                        "maxzoom": 7,
                        "layout": {},
                        "paint": {
                            "fill-color": "hsl(55, 1%, 20%)",
                            "fill-opacity": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                2,
                                0.3,
                                7,
                                0
                            ],
                            "fill-antialias": false
                        }
                    },
                    {
                        "id": "national-park",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "landuse_overlay",
                        "minzoom": 5,
                        "filter": ["==", ["get", "class"], "national_park"],
                        "layout": {},
                        "paint": {
                            "fill-color": "hsl(132, 2%, 20%)",
                            "fill-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                5,
                                0,
                                6,
                                0.5
                            ]
                        }
                    },
                    {
                        "id": "landuse",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "landuse",
                        "minzoom": 5,
                        "filter": [
                            "match",
                            ["get", "class"],
                            ["park", "airport", "glacier", "pitch", "sand"],
                            true,
                            false
                        ],
                        "layout": {},
                        "paint": {
                            "fill-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                5,
                                0,
                                6,
                                ["match", ["get", "class"], "glacier", 0.5, 1]
                            ],
                            "fill-color": "#00142f"
                        }
                    },
                    {
                        "id": "water-shadow",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "water",
                        "layout": {},
                        "paint": {
                            "fill-translate-anchor": "viewport",
                            "fill-translate": [
                                "interpolate",
                                ["exponential", 1.2],
                                ["zoom"],
                                7,
                                ["literal", [0, 0]],
                                16,
                                ["literal", [-1, -1]]
                            ],
                            "fill-color": "#0c0d0d"
                        }
                    },
                    {
                        "id": "waterway",
                        "type": "line",
                        "source": "composite",
                        "source-layer": "waterway",
                        "minzoom": 8,
                        "layout": {
                            "line-cap": ["step", ["zoom"], "butt", 11, "round"],
                            "line-join": "round"
                        },
                        "paint": {
                            "line-color": "#05325b",
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.3],
                                ["zoom"],
                                9,
                                ["match", ["get", "class"], ["canal", "river"], 0.1, 0],
                                20,
                                ["match", ["get", "class"], ["canal", "river"], 8, 3]
                            ],
                            "line-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                8,
                                0,
                                8.5,
                                1
                            ]
                        }
                    },
                    {
                        "id": "water",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "water",
                        "layout": {},
                        "paint": {"fill-color": "#05325b"}
                    },
                    {
                        "id": "hillshade",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "hillshade",
                        "maxzoom": 16,
                        "layout": {},
                        "paint": {
                            "fill-color": [
                                "match",
                                ["get", "class"],
                                "shadow",
                                "#00142f",
                                "hsl(0, 0%, 100%)"
                            ],
                            "fill-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                14,
                                [
                                    "match",
                                    ["get", "level"],
                                    [67, 56],
                                    0.06,
                                    [89, 78],
                                    0.03,
                                    0.04
                                ],
                                16,
                                0
                            ],
                            "fill-antialias": false
                        }
                    },
                    {
                        "id": "land-structure-polygon",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "structure",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["geometry-type"], "Polygon"],
                            ["==", ["get", "class"], "land"]
                        ],
                        "layout": {},
                        "paint": {"fill-color": "#011d42"}
                    },
                    {
                        "id": "land-structure-line",
                        "type": "line",
                        "source": "composite",
                        "source-layer": "structure",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["geometry-type"], "LineString"],
                            ["==", ["get", "class"], "land"]
                        ],
                        "layout": {"line-cap": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.99],
                                ["zoom"],
                                14,
                                0.75,
                                20,
                                40
                            ],
                            "line-color": "hsl(55, 1%, 20%)"
                        }
                    },
                    {
                        "id": "aeroway-polygon",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "aeroway",
                        "minzoom": 11,
                        "filter": [
                            "all",
                            ["==", ["geometry-type"], "Polygon"],
                            [
                                "match",
                                ["get", "type"],
                                ["runway", "taxiway", "helipad"],
                                true,
                                false
                            ]
                        ],
                        "layout": {},
                        "paint": {
                            "fill-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                11,
                                0,
                                11.5,
                                1
                            ]
                        }
                    },
                    {
                        "id": "aeroway-line",
                        "type": "line",
                        "source": "composite",
                        "source-layer": "aeroway",
                        "minzoom": 9,
                        "filter": ["==", ["geometry-type"], "LineString"],
                        "layout": {},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                9,
                                [
                                    "match",
                                    ["get", "type"],
                                    "runway",
                                    1,
                                    "taxiway",
                                    0.5,
                                    0.5
                                ],
                                18,
                                ["match", ["get", "type"], "runway", 80, "taxiway", 20, 20]
                            ],
                            "line-color": "hsl(0, 0%, 27%)"
                        }
                    },
                    {
                        "id": "building",
                        "type": "fill",
                        "source": "composite",
                        "source-layer": "building",
                        "minzoom": 15,
                        "filter": [
                            "all",
                            ["!=", ["get", "type"], "building:part"],
                            ["==", ["get", "underground"], "false"]
                        ],
                        "layout": {},
                        "paint": {
                            "fill-outline-color": "hsl(55, 1%, 15%)",
                            "fill-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                15,
                                0,
                                16,
                                1
                            ],
                            "fill-color": "#013878"
                        }
                    },
                    {
                        "id": "tunnel-street-minor-low",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "step",
                                ["zoom"],
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "track", "primary_link"],
                                    true,
                                    false
                                ],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    [
                                        "street",
                                        "street_limited",
                                        "track",
                                        "primary_link",
                                        "secondary_link",
                                        "tertiary_link",
                                        "service"
                                    ],
                                    true,
                                    false
                                ]
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    2,
                                    "track",
                                    1,
                                    0.5
                                ],
                                18,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    18,
                                    12
                                ]
                            ],
                            "line-color": "hsl(185, 2%, 15%)",
                            "line-opacity": ["step", ["zoom"], 1, 14, 0]
                        }
                    },
                    {
                        "id": "tunnel-street-minor-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "step",
                                ["zoom"],
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "track", "primary_link"],
                                    true,
                                    false
                                ],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    [
                                        "street",
                                        "street_limited",
                                        "track",
                                        "primary_link",
                                        "secondary_link",
                                        "tertiary_link",
                                        "service"
                                    ],
                                    true,
                                    false
                                ]
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.75,
                                20,
                                2
                            ],
                            "line-color": "hsl(185, 2%, 29%)",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    2,
                                    "track",
                                    1,
                                    0.5
                                ],
                                18,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    18,
                                    12
                                ]
                            ],
                            "line-opacity": ["step", ["zoom"], 0, 14, 1],
                            "line-dasharray": [3, 3]
                        }
                    },
                    {
                        "id": "tunnel-primary-secondary-tertiary-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "match",
                                ["get", "class"],
                                ["primary", "secondary", "tertiary"],
                                true,
                                false
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                10,
                                [
                                    "match",
                                    ["get", "class"],
                                    "primary",
                                    1,
                                    ["secondary", "tertiary"],
                                    0.75,
                                    0.75
                                ],
                                18,
                                2
                            ],
                            "line-color": "#484b4b",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                [
                                    "match",
                                    ["get", "class"],
                                    "primary",
                                    0.75,
                                    ["secondary", "tertiary"],
                                    0.1,
                                    0.1
                                ],
                                18,
                                [
                                    "match",
                                    ["get", "class"],
                                    "primary",
                                    32,
                                    ["secondary", "tertiary"],
                                    26,
                                    26
                                ]
                            ],
                            "line-dasharray": [3, 3]
                        }
                    },
                    {
                        "id": "tunnel-major-link-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "match",
                                ["get", "class"],
                                ["motorway_link", "trunk_link"],
                                true,
                                false
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.75,
                                20,
                                2
                            ],
                            "line-color": "hsl(185, 2%, 29%)",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-dasharray": [3, 3]
                        }
                    },
                    {
                        "id": "tunnel-motorway-trunk-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["match", ["get", "class"], ["motorway", "trunk"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                10,
                                1,
                                18,
                                2
                            ],
                            "line-color": "hsl(185, 2%, 29%)",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ],
                            "line-dasharray": [3, 3]
                        }
                    },
                    {
                        "id": "tunnel-construction",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 14,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["==", ["get", "class"], "construction"],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-color": "hsl(187, 2%, 15%)",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [0.4, 0.8]],
                                15,
                                ["literal", [0.3, 0.6]],
                                16,
                                ["literal", [0.2, 0.3]],
                                17,
                                ["literal", [0.2, 0.25]],
                                18,
                                ["literal", [0.15, 0.15]]
                            ]
                        }
                    },
                    {
                        "id": "tunnel-path",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["==", ["get", "class"], "path"],
                            ["!=", ["get", "type"], "steps"],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                15,
                                1,
                                18,
                                4
                            ],
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.75, 1]],
                                16,
                                ["literal", [1, 0.75]],
                                17,
                                ["literal", [1, 0.5]]
                            ],
                            "line-color": "hsl(185, 2%, 15%)"
                        }
                    },
                    {
                        "id": "tunnel-steps",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 14,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["==", ["get", "class"], "steps"],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                15,
                                1,
                                16,
                                1.6,
                                18,
                                6
                            ],
                            "line-color": "hsl(185, 2%, 15%)",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.75, 1]],
                                16,
                                ["literal", [1, 0.75]],
                                17,
                                ["literal", [0.3, 0.3]]
                            ]
                        }
                    },
                    {
                        "id": "tunnel-major-link",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "match",
                                ["get", "class"],
                                ["motorway_link", "trunk_link"],
                                true,
                                false
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-color": "hsl(185, 2%, 15%)"
                        }
                    },
                    {
                        "id": "tunnel-pedestrian",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["==", ["get", "class"], "pedestrian"],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                0.5,
                                18,
                                12
                            ],
                            "line-color": "hsl(185, 2%, 15%)",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.5, 0.4]],
                                16,
                                ["literal", [1, 0.2]]
                            ]
                        }
                    },
                    {
                        "id": "tunnel-street-minor",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "step",
                                ["zoom"],
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "track", "primary_link"],
                                    true,
                                    false
                                ],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    [
                                        "street",
                                        "street_limited",
                                        "track",
                                        "primary_link",
                                        "secondary_link",
                                        "tertiary_link",
                                        "service"
                                    ],
                                    true,
                                    false
                                ]
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    2,
                                    "track",
                                    1,
                                    0.5
                                ],
                                18,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["street", "street_limited", "primary_link"],
                                    18,
                                    12
                                ]
                            ],
                            "line-color": "hsl(185, 2%, 15%)",
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "tunnel-primary-secondary-tertiary",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            [
                                "match",
                                ["get", "class"],
                                ["primary", "secondary", "tertiary"],
                                true,
                                false
                            ],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                [
                                    "match",
                                    ["get", "class"],
                                    "primary",
                                    0.75,
                                    ["secondary", "tertiary"],
                                    0.1,
                                    0.1
                                ],
                                18,
                                [
                                    "match",
                                    ["get", "class"],
                                    "primary",
                                    32,
                                    ["secondary", "tertiary"],
                                    26,
                                    26
                                ]
                            ],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "tunnel-motorway-trunk",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855769305.6016"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            ["==", ["get", "structure"], "tunnel"],
                            ["match", ["get", "class"], ["motorway", "trunk"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ],
                            "line-color": "hsl(185, 2%, 15%)"
                        }
                    },
                    {
                        "id": "road-pedestrian-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 12,
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "pedestrian"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                2,
                                18,
                                14.5
                            ],
                            "line-color": "#000000",
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "road-minor-low",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            [
                                "step",
                                ["zoom"],
                                ["==", ["get", "class"], "track"],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["track", "secondary_link", "tertiary_link", "service"],
                                    true,
                                    false
                                ]
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                ["match", ["get", "class"], "track", 1, 0.5],
                                18,
                                12
                            ],
                            "line-opacity": ["step", ["zoom"], 1, 14, 0],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "road-street-low",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 11,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["street", "street_limited", "primary_link"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-opacity": ["step", ["zoom"], 1, 14, 0],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "road-minor-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            [
                                "step",
                                ["zoom"],
                                ["==", ["get", "class"], "track"],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["track", "secondary_link", "tertiary_link", "service"],
                                    true,
                                    false
                                ]
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.75,
                                20,
                                2
                            ],
                            "line-color": "#413201",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                ["match", ["get", "class"], "track", 1, 0.5],
                                18,
                                12
                            ],
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "road-street-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 11,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["street", "street_limited", "primary_link"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.75,
                                20,
                                2
                            ],
                            "line-color": "#000000",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "road-secondary-tertiary-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["secondary", "tertiary"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                10,
                                0.75,
                                18,
                                2
                            ],
                            "line-color": "#413201",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.1,
                                18,
                                26
                            ]
                        }
                    },
                    {
                        "id": "road-primary-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "primary"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                10,
                                1,
                                18,
                                2
                            ],
                            "line-color": "#413201",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ]
                        }
                    },
                    {
                        "id": "road-major-link-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 10,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["motorway_link", "trunk_link"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.75,
                                20,
                                2
                            ],
                            "line-color": "#000000",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-opacity": ["step", ["zoom"], 0, 11, 1]
                        }
                    },
                    {
                        "id": "road-motorway-trunk-case",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            ["match", ["get", "class"], ["motorway", "trunk"], true, false],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                10,
                                1,
                                18,
                                2
                            ],
                            "line-color": "#000000",
                            "line-gap-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ],
                            "line-opacity": [
                                "step",
                                ["zoom"],
                                ["match", ["get", "class"], "motorway", 1, 0],
                                6,
                                1
                            ]
                        }
                    },
                    {
                        "id": "road-construction",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 14,
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "construction"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-color": "#000000",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [0.4, 0.8]],
                                15,
                                ["literal", [0.3, 0.6]],
                                16,
                                ["literal", [0.2, 0.3]],
                                17,
                                ["literal", [0.2, 0.25]],
                                18,
                                ["literal", [0.15, 0.15]]
                            ]
                        }
                    },
                    {
                        "id": "road-path",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 12,
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "path"],
                            [
                                "step",
                                ["zoom"],
                                [
                                    "!",
                                    [
                                        "match",
                                        ["get", "type"],
                                        ["steps", "sidewalk", "crossing"],
                                        true,
                                        false
                                    ]
                                ],
                                16,
                                ["!=", ["get", "type"], "steps"]
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                13,
                                0.5,
                                14,
                                1,
                                15,
                                1,
                                18,
                                4
                            ],
                            "line-color": "#000000",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.75, 1]],
                                16,
                                ["literal", [1, 0.75]],
                                17,
                                ["literal", [1, 0.5]]
                            ]
                        }
                    },
                    {
                        "id": "road-steps",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 14,
                        "filter": [
                            "all",
                            ["==", ["get", "type"], "steps"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                15,
                                1,
                                16,
                                1.6,
                                18,
                                6
                            ],
                            "line-color": "#000000",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.75, 1]],
                                16,
                                ["literal", [1, 0.75]],
                                17,
                                ["literal", [0.3, 0.3]]
                            ]
                        }
                    },
                    {
                        "id": "road-major-link",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 10,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["motorway_link", "trunk_link"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "road-pedestrian",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 12,
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "pedestrian"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                0.5,
                                18,
                                12
                            ],
                            "line-color": "#000000",
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [1, 0]],
                                15,
                                ["literal", [1.5, 0.4]],
                                16,
                                ["literal", [1, 0.2]]
                            ]
                        }
                    },
                    {
                        "id": "road-minor",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            [
                                "step",
                                ["zoom"],
                                ["==", ["get", "class"], "track"],
                                14,
                                [
                                    "match",
                                    ["get", "class"],
                                    ["track", "secondary_link", "tertiary_link", "service"],
                                    true,
                                    false
                                ]
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                ["match", ["get", "class"], "track", 1, 0.5],
                                18,
                                12
                            ],
                            "line-color": "#000000",
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "road-street",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 11,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["street", "street_limited", "primary_link"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                12,
                                0.5,
                                14,
                                2,
                                18,
                                18
                            ],
                            "line-color": "#000000",
                            "line-opacity": ["step", ["zoom"], 0, 14, 1]
                        }
                    },
                    {
                        "id": "road-secondary-tertiary",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["secondary", "tertiary"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.1,
                                18,
                                26
                            ],
                            "line-color": "#030303"
                        }
                    },
                    {
                        "id": "road-primary",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            ["==", ["get", "class"], "primary"],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "road-motorway-trunk",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "filter": [
                            "all",
                            ["match", ["get", "class"], ["motorway", "trunk"], true, false],
                            ["match", ["get", "structure"], ["none", "ford"], true, false],
                            ["==", ["geometry-type"], "LineString"]
                        ],
                        "layout": {"line-cap": "round", "line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                5,
                                0.75,
                                18,
                                32
                            ],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "road-rail",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444855786460.0557"},
                        "source": "composite",
                        "source-layer": "road",
                        "minzoom": 13,
                        "filter": [
                            "all",
                            [
                                "match",
                                ["get", "class"],
                                ["major_rail", "minor_rail"],
                                true,
                                false
                            ],
                            ["match", ["get", "structure"], ["none", "ford"], true, false]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["exponential", 1.5],
                                ["zoom"],
                                14,
                                0.5,
                                20,
                                1
                            ],
                            "line-color": "#000000"
                        }
                    },
                    {
                        "id": "admin-1-boundary-bg",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444934295202.7542"},
                        "source": "composite",
                        "source-layer": "admin",
                        "filter": [
                            "all",
                            ["==", ["get", "admin_level"], 1],
                            ["==", ["get", "maritime"], "false"],
                            ["match", ["get", "worldview"], ["all", "US"], true, false]
                        ],
                        "layout": {"line-join": "bevel"},
                        "paint": {
                            "line-blur": ["interpolate", ["linear"], ["zoom"], 3, 0, 8, 3],
                            "line-width": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                7,
                                3.75,
                                12,
                                5.5
                            ],
                            "line-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                7,
                                0,
                                8,
                                0.75
                            ],
                            "line-dasharray": [1, 0],
                            "line-translate": [0, 0],
                            "line-color": "hsl(0, 0%, 10%)"
                        }
                    },
                    {
                        "id": "admin-0-boundary-bg",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444934295202.7542"},
                        "source": "composite",
                        "source-layer": "admin",
                        "minzoom": 1,
                        "filter": [
                            "all",
                            ["==", ["get", "admin_level"], 0],
                            ["==", ["get", "maritime"], "false"],
                            ["match", ["get", "worldview"], ["all", "US"], true, false]
                        ],
                        "layout": {},
                        "paint": {
                            "line-width": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                3,
                                3.5,
                                10,
                                8
                            ],
                            "line-color": "hsl(0, 0%, 10%)",
                            "line-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                3,
                                0,
                                4,
                                0.5
                            ],
                            "line-translate": [0, 0],
                            "line-blur": ["interpolate", ["linear"], ["zoom"], 3, 0, 10, 2]
                        }
                    },
                    {
                        "id": "admin-1-boundary",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444934295202.7542"},
                        "source": "composite",
                        "source-layer": "admin",
                        "filter": [
                            "all",
                            ["==", ["get", "admin_level"], 1],
                            ["==", ["get", "maritime"], "false"],
                            ["match", ["get", "worldview"], ["all", "US"], true, false]
                        ],
                        "layout": {"line-join": "round", "line-cap": "round"},
                        "paint": {
                            "line-dasharray": [
                                "step",
                                ["zoom"],
                                ["literal", [2, 0]],
                                7,
                                ["literal", [2, 2, 6, 2]]
                            ],
                            "line-width": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                7,
                                0.75,
                                12,
                                1.5
                            ],
                            "line-opacity": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                2,
                                0,
                                3,
                                1
                            ],
                            "line-color": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                3,
                                "hsl(0, 0%, 27%)",
                                7,
                                "hsl(0, 0%, 35%)"
                            ]
                        }
                    },
                    {
                        "id": "admin-0-boundary",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444934295202.7542"},
                        "source": "composite",
                        "source-layer": "admin",
                        "minzoom": 1,
                        "filter": [
                            "all",
                            ["==", ["get", "admin_level"], 0],
                            ["==", ["get", "disputed"], "false"],
                            ["==", ["get", "maritime"], "false"],
                            ["match", ["get", "worldview"], ["all", "US"], true, false]
                        ],
                        "layout": {"line-join": "round", "line-cap": "round"},
                        "paint": {
                            "line-color": "hsl(0, 0%, 43%)",
                            "line-width": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                3,
                                0.5,
                                10,
                                2
                            ]
                        }
                    },
                    {
                        "id": "admin-0-boundary-disputed",
                        "type": "line",
                        "metadata": {"mapbox:group": "1444934295202.7542"},
                        "source": "composite",
                        "source-layer": "admin",
                        "minzoom": 1,
                        "filter": [
                            "all",
                            ["==", ["get", "disputed"], "true"],
                            ["==", ["get", "admin_level"], 0],
                            ["==", ["get", "maritime"], "false"],
                            ["match", ["get", "worldview"], ["all", "US"], true, false]
                        ],
                        "layout": {"line-join": "round"},
                        "paint": {
                            "line-dasharray": [1.5, 1.5],
                            "line-color": "hsl(0, 0%, 14%)",
                            "line-width": [
                                "interpolate",
                                ["linear"],
                                ["zoom"],
                                3,
                                0.5,
                                10,
                                2
                            ]
                        }
                    },
                  {
                      "id": "lines",
                      "type": "line",
                      "metadata": {},
                      "source": "lines",
                      // "source-layer": "lines",
                      "layout": {},
                      "paint": {"line-color": ["get", "color"], "line-width": 1.5}
                  },
                    {
                        "id": "buildings-1py8ql",
                        "type": "fill-extrusion",
                        "source": "building",
                        // "source-layer": "buildings-1py8ql",
                        "layout": {},
                        "paint": {
                            "fill-extrusion-color": "#013878",
                            "fill-extrusion-height": ["get", "height"]
                        }
                    }
                ],
            };
            var map = new mapboxgl.Map({
              container: 'oVbaseMap',
              style:MAPSTYLE
            });
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="mapboxgl点击图层polygon抬升"><a href="#mapboxgl点击图层polygon抬升" class="headerlink" title="mapboxgl点击图层polygon抬升"></a>mapboxgl点击图层polygon抬升</h2><pre class="line-numbers language-html"><code class="language-html">  //点击行政区块效果
  this.map.addSource("markers",{
      "type":"geojson",
      "data":line_json_from
  });         
  //普通贴地的多边形polygon
  this.map.addLayer({
    "id":"markers_polygon",
    "type":"fill",
    "visibility": "visible", 
    "source": "markers", 
    "paint":{
      "fill-color": "#0000ff",  
      "fill-opacity":0.5
    }
  });

  this.map.addLayer({
    'id': 'provinceHighlight',
    'type': 'fill-extrusion',
    'source': 'markers',
    //'source-layer': 'markers',
    'layout': { 'visibility': 'visible' },
    'paint': {
      'fill-extrusion-vertical-gradient': true,
      'fill-extrusion-color': '#00ff00',
      'fill-extrusion-height': 3500,
      // 'fill-extrusion-height': {"stops": [[0, 100000], [18, 20000]]},
      'fill-extrusion-base': 200,
      'fill-extrusion-opacity': 0.8
    },
    //图层过滤显示:加载图层时，要控制显示和隐藏其中的某些元素，需要使用mapbox-gl的图层过滤接口。
    'filter': ['==', 'name', '']
  });


  this.map.on('click','markers_polygon',function(e){
   // console.log(e.features[0]["properties"]["name"]);
   // console.log(e.features[0]);
   // 图层整体属性修改
   // that.map.setPaintProperty('markers_polygon','fill-color','#ff0000');  
   // 图层内部分属性修改(部分，图层内容过滤)
   that.map.setFilter('provinceHighlight', ['==', 'name', e.features[0]["properties"]["name"]])
  });
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Mapbox引入Threejs后通过射线检测触发三维模型"><a href="#Mapbox引入Threejs后通过射线检测触发三维模型" class="headerlink" title="Mapbox引入Threejs后通过射线检测触发三维模型"></a>Mapbox引入Threejs后通过射线检测触发三维模型</h2><pre class="line-numbers language-html"><code class="language-html"> addEventListen:function(){
    var that=this;

     //通过发射射线触发三维模型
    that.map.on('click',function(event){
        event.preventDefault();
        console.log(event);
        var raycaster=new THREE.Raycaster();
        var mouse=new THREE.Vector2();
        mouse.x=(event.point.x/window.innerWidth)*2-1;
        mouse.y=-(event.point.y/window.innerHeight)*2+1;
        console.log(mouse);

        raycaster.setFromCamera(mouse,that.camera);
        var intersects=raycaster.intersectObjects(that.scene.children);
        if(intersects.length>0){
            console.log(intersects[0].object);
            //doSomethingSelectObj(intersects[0].object);
        }else{
           console.log("un clicked");
        }            
    });
  },
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Mapboxgl-Marker的根据缩放级别显隐控制"><a href="#Mapboxgl-Marker的根据缩放级别显隐控制" class="headerlink" title="Mapboxgl.Marker的根据缩放级别显隐控制"></a>Mapboxgl.Marker的根据缩放级别显隐控制</h2><pre class="line-numbers language-html"><code class="language-html">
return{
...
    markerArr:[],
...
}

that.addMarkerCustom("大丰","92",[120.56852984099595,33.22370594310354]);  


addMarkerCustom(markName,markValue,lnglat){            
    var ele6060=document.createElement('div');
    ele6060.innerHTML=`
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url('/static/locate.png')</span><span class="token punctuation">;</span><span class="token property">background-repeat</span><span class="token punctuation">:</span> no-repeat<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">120</span>px<span class="token punctuation">;</span><span class="token property">background-size</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">8</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span><span class="token number">20</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>`+markName+`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  `+
    `<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">25</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>`+markValue+`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> `+
    `<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    `;
    document.body.appendChild(ele6060);
    var marker6060 = new Mapboxgl.Marker({
        draggable: false,
        element: ele6060,
    });
    marker6060.setLngLat(lnglat); 
    marker6060.addTo(this.map); 
    this.markerArr.push(ele6060);
}

this.map.on('render',(e)=>{
  if(e.target.getZoom()&lt;7.2){
    for(let i=0;i&lt; this.markerArr.length;i++){
      this.markerArr[i].style["display"]="none"; 
    }
  }else{
    for(let i=0;i&lt; this.markerArr.length;i++){
      this.markerArr[i].style["display"]="block"; 
    }
  }
});
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="mapbox添加自定义标签-css本地图片"><a href="#mapbox添加自定义标签-css本地图片" class="headerlink" title="mapbox添加自定义标签(css本地图片)"></a>mapbox添加自定义标签(css本地图片)</h2><pre class="line-numbers language-html"><code class="language-html">
import img1 from './publicn3locate.svg'  

addMarkerCustom(markName,markValue,lnglat){       
      var ele6060=document.createElement('div');
      ele6060.innerHTML=`
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mymark<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background-repeat</span><span class="token punctuation">:</span> no-repeat<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">120</span>px<span class="token punctuation">;</span><span class="token property">background-size</span><span class="token punctuation">:</span><span class="token number">100%</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">100</span>px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">8</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span><span class="token number">30</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>`+markName+`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  `+
      `<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>white<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">25</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>`+markValue+`<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> `+
      `<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      `;
      ele6060.getElementsByClassName("mymark")[0].style.backgroundImage = `url("${img1}")`;

      document.body.appendChild(ele6060);
      var marker6060 = new Mapboxgl.Marker({
          draggable: false,
          element: ele6060,
      });
      marker6060.setLngLat(lnglat); 
      marker6060.addTo(this.map); 
      this.markerArr.push(ele6060);
},
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            
            
            
            <div class="reprint1">
                <p>
                    <span class="reprint1-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://127.0.0.1/diary" class="b-link-green">车舟慢</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/diary/2021/09/19/diary-20210919-1/" class="b-link-green">MapboxGL在Vue中实践</a>
                </p>
            </div>

        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }
	
	/*zs shuai*/
	#vcomments{
		display:none;
	}
	
    /* valine 评论框增加背景图片 */
    #vcomments textarea {
        box-sizing: border-box;
        background: url("") 100% 100% no-repeat;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    /* 修复评论第一行位置错位 */
    .v .vlist .vcard {
    padding-top: 2.5em !important ;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="/libs//libs/jQuery-emoji/dist/css/jquery.emoji.css">
<script src="/libs//libs/jQuery-emoji/dist/js/jquery.emoji.min.js"></script>
<script src="/libs//libs/jQuery-emoji/dist/js/emoji.list.js"></script> -->
<script>
    new Valine({
        el: '#vcomments',
        appId: '2Kc1yifl00dRA6CYQxICVIe4-MdYXbMMI',
        appKey: 'xni6ILbDL2WVE4HDucMuDtx7',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: '',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go ヾﾉ≧∀≦)o ',

    });

//     function parse_emoji() {
//     jQuery(".vcontent").emojiParse({
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists   // 注：详见 js/emoji.list.js
//     });
//   }
  
//   setTimeout(function() {
//     // jQuery emoji 解析
//     parse_emoji();
//     // jquery emoji 初始化
//     jQuery(".veditor").emoji({
//       showTab: true,
//       animation: 'slide',
//       basePath: '/libs/jQuery-emoji/images/emoji',
//       icons: emojiLists  // 注：详见 js/emoji.list.js
//     });
//     jQuery(".vmore").on("click", function() {
//       setTimeout(function() {
//         parse_emoji();
//       }, 500);
//     });
//   }, 800)

</script>
    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/diary/2021/09/27/diary-20210927/">
                    <div class="card-image">
                        
                        
                        <img src="/diary/medias/featureimages/22.jpg" class="responsive-img" alt="VUE和Express前后端分离开发">
                        
                        <span class="card-title">VUE和Express前后端分离开发</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            VUE+Express前后端分离的开发环境请确保安装了node，Window+R打开cmd，输入node -V查看node版本。  
搭建后台Express开发环境cmd命令行进入目标目录  
npm init //初始化项目  
npm 
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2021-09-27
                        </span>
                        <span class="publish-author">
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/diary/tags/Vue/" target="_blank">
                        <span class="chip bg-color">Vue</span>
                    </a>
                    
                    <a href="/diary/tags/Express/" target="_blank">
                        <span class="chip bg-color">Express</span>
                    </a>
                    
                    <a href="/diary/tags/axios/" target="_blank">
                        <span class="chip bg-color">axios</span>
                    </a>
                    
                    <a href="/diary/tags/mockjs/" target="_blank">
                        <span class="chip bg-color">mockjs</span>
                    </a>
                    
                    <a href="/diary/tags/同-异步任务队列/" target="_blank">
                        <span class="chip bg-color">同/异步任务队列</span>
                    </a>
                    
                    <a href="/diary/tags/iframe/" target="_blank">
                        <span class="chip bg-color">iframe</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/diary/2021/09/16/diary-20210916-1/">
                    <div class="card-image">
                        
                        
                        <img src="/diary/medias/featureimages/23.jpg" class="responsive-img" alt="Docker实践">
                        
                        <span class="card-title">Docker实践</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Docker for Window实践运行中的容器共享宿主机内核，Window容器运行在Window宿主机上，Linux容器运行在Linux宿主机上，意味着基于window的容器化应用无法在Linux主机运行。  
Kbuernetes是保
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2021-09-16
                            </span>
                        <span class="publish-author">
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/diary/tags/Docker/" target="_blank">
                        <span class="chip bg-color">Docker</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 车舟慢<br />'
            + '作者: <br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/diary/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


        <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            

            <br>
            <span id="sitetime"></span><span class="my-face">ღゝ◡╹)ノ♡</span>
            <br>

            

            
            <!--
            
			
                &nbsp; | &nbsp;字数统计:&nbsp;
    <span class="white-color">650.5k</span> 字  
			
            
			
			-->

            
            <br>

        </div>

        <div class="col s12 m4 l4 social-link social-statis">

 
    <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=617641594@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>






    <a href="http://wpa.qq.com/msgrd?v=3&uin=617641594&site=qq&menu=yes" class="tooltipped" target="_blank" data-tooltip="访问我的QQ空间" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>




<!--

    <a href="/diary/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>

--></div>

    </div>
</footer>

<div class="progress-bar"></div>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();

        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */

        var t1 = Date.UTC(2020, 5, 1, 00, 00, 00); //北京时间2019-8-1 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes *
            minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已坚持运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours +
            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒" ;
    } /*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>






        <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>
<script src="/diary/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/diary/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
        <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


        <script src="/diary/libs/materialize/materialize.min.js"></script>
        <script src="/diary/libs/masonry/masonry.pkgd.min.js"></script>
        <script src="/diary/libs/aos/aos.js"></script>
        <script src="/diary/libs/scrollprogress/scrollProgress.min.js"></script>
        <script src="/diary/libs/lightGallery/js/lightgallery-all.min.js"></script>
        <script src="/diary/js/matery.js"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->



        
            <script src="/diary/libs/others/clicklove.js"></script>
        

        

        
        <script type="text/javascript">
            var OriginTitile = document.title,
                st;
            document.addEventListener("visibilitychange", function () {
                document.hidden ? (document.title = "看不见我🙈~看不见我🙈~", clearTimeout(st)) : (document.title =
                    "(๑•̀ㅂ•́) ✧被发现了～", st = setTimeout(function () {
                        document.title = OriginTitile
                    }, 3e3))
            })
        </script>

       
        

        
        

    
        

    
        

        

        
        

        
        

        
        
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 992) {
                document.write('<script type="text/javascript" src="/diary/libs/background/ribbon-dynamic.js"><\/script>');
            }
            </script>
        

    <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>
</html>